facet_grid(~npz_id,
scales = "free_x",
space = "free",
drop = TRUE) +
labs(x = "NPZ",
y = "Proportion hours per day with vessels") +
theme(
strip.text.x = element_text(face = "bold"),
axis.text.x = element_text(face = "bold")
)
# Plot proportion of hours present per day
ggplot(data = all_ves_prop_hrs_day |>
# only want to plot presence
filter(ves_yn == "Y"),
aes(x = Weekday,
y = Perc_per_hour))+
geom_boxplot(aes(fill = npz_id),
position = position_dodge2(preserve = "single"),
alpha = 0.5,
width = 0.5)+
scale_fill_viridis_d(end = 0.75,
direction = -1,
guide = "none")+
scale_color_viridis_d(end = 0.75,
direction = -1,
guide = "none")+
facet_grid(rows = vars(npz_id),
scales = "free_x",
space = "free",
drop = TRUE) +
labs(x = "NPZ",
y = "Proportion hours per day with vessels") +
theme(
strip.text.x = element_text(face = "bold"),
axis.text.x = element_text(face = "bold")
)
# Plot proportion of hours present per day
ggplot(data = all_ves_prop_hrs_day |>
# only want to plot presence
filter(ves_yn == "Y"),
aes(x = Weekday,
y = Perc_per_hour))+
geom_boxplot(aes(fill = network),
position = position_dodge2(preserve = "single"),
alpha = 0.5,
width = 0.5)+
scale_fill_viridis_d(end = 0.75,
direction = -1,
guide = "none")+
scale_color_viridis_d(end = 0.75,
direction = -1,
guide = "none")+
facet_grid(rows = vars(npz_id),
scales = "free_x",
space = "free",
drop = TRUE) +
labs(x = "NPZ",
y = "Proportion hours per day with vessels") +
theme(
strip.text.x = element_text(face = "bold"),
axis.text.x = element_text(face = "bold")
)
# Plot proportion of hours present per day
ggplot(data = all_ves_prop_hrs_day |>
# only want to plot presence
filter(ves_yn == "Y"),
aes(x = Weekday,
y = Perc_per_hour))+
geom_boxplot(aes(fill = network,
color = network),
position = position_dodge2(preserve = "single"),
alpha = 0.5,
width = 0.5)+
scale_fill_viridis_d(end = 0.75,
direction = -1,
guide = "none")+
scale_color_viridis_d(end = 0.75,
direction = -1,
guide = "none")+
facet_grid(rows = vars(npz_id),
scales = "free_x",
space = "free",
drop = TRUE) +
labs(x = "NPZ",
y = "Proportion hours per day with vessels") +
theme(
strip.text.x = element_text(face = "bold"),
axis.text.x = element_text(face = "bold")
)
# Plot proportion of hours present per day
ggplot(data = all_ves_prop_hrs_day |>
# only want to plot presence
filter(ves_yn == "Y"),
aes(x = Weekday,
y = Perc_per_hour))+
geom_boxplot(aes(fill = network,
color = network),
position = position_dodge2(preserve = "single"),
alpha = 0.5,
width = 0.25)+
scale_fill_viridis_d(end = 0.75,
direction = -1,
guide = "none")+
scale_color_viridis_d(end = 0.75,
direction = -1,
guide = "none")+
facet_grid(rows = vars(npz_id),
scales = "free_x",
space = "free",
drop = TRUE) +
labs(x = "NPZ",
y = "Proportion hours per day with vessels") +
theme(
strip.text.x = element_text(face = "bold"),
axis.text.x = element_text(face = "bold")
)
# Plot proportion of hours present per day
ggplot(data = all_ves_prop_hrs_day |>
# only want to plot presence
filter(ves_yn == "Y"),
aes(x = Weekday,
y = Perc_per_hour))+
geom_boxplot(aes(fill = network,
color = network),
position = position_dodge2(preserve = "single"),
alpha = 0.5,
width = 0.25)+
scale_fill_viridis_d(end = 0.75,
direction = -1,
guide = "none")+
scale_color_viridis_d(end = 0.75,
direction = -1,
guide = "none")+
facet_grid(rows = vars(npz_id),
scales = "free_x",
space = "free",
drop = TRUE) +
labs(x = "NPZ",
y = "Proportion hours per day with vessels") +
theme(
strip.text.y = element_text(face = "bold"),
axis.text.x = element_text(face = "bold")
)
# Plot proportion of hours present per day
ggplot(data = all_ves_prop_hrs_day |>
# only want to plot presence
filter(ves_yn == "Y"),
aes(x = Weekday,
y = Perc_per_hour))+
geom_boxplot(aes(fill = network,
color = network),
position = position_dodge2(preserve = "single"),
alpha = 0.5,
width = 0.25)+
scale_fill_viridis_d(end = 0.75,
direction = -1,
guide = "none")+
scale_color_viridis_d(end = 0.75,
direction = -1,
guide = "none")+
facet_grid(rows = vars(npz_id),
scales = "free_x",
space = "free",
drop = TRUE) +
labs(x = "Weekday",
y = "Proportion hours per day with vessels") +
theme(
strip.text.y = element_text(face = "bold"),
axis.text.x = element_text(face = "bold")
)
all_ves_prop_hrs_day <- all_sites_hp |>
# group by y/n column
group_by(network, npz_id, Site_ID, Dep, Date_week, Weekday, Begin_Date_loc,
ves_yn) |>
# get total number of hours for Y and N groups per each hour per deployment
summarize(n_hours = n())|>
mutate(freq = n_hours/sum(n_hours)) |>
ungroup() |>
complete(Site_ID, ves_yn,
fill = list(ves_yn = "Y", freq = 0)) |>
group_by(Site_ID, ves_yn) |>
# reshape for easier plotting
pivot_longer(cols = c("freq"),
values_to = "Perc_per_hour") |>
mutate(network = factor(network, levels = c("Temperate East","Northwest","South-west"))) |>
mutate(Weekday = factor(Weekday, levels=c("Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday")),
network = case_when(Site_ID == "CG" | Site_ID == "EP" | Site_ID == "WP" ~ "Temperate East",
Site_ID == "DNE" | Site_ID == "DSW" | Site_ID == "NGN"| Site_ID == "NGS" ~ "Northwest",
TRUE ~ "South-west"
),
network = fct(network),
network = fct_relevel(network, c("Temperate East","Northwest")))
levels(all_ves_prop_hrs_day$Weekday) <- c("M","T","W","R","F","Sa","Su")
# Plot proportion of hours present per day
ggplot(data = all_ves_prop_hrs_day |>
# only want to plot presence
filter(ves_yn == "Y"),
aes(x = Weekday,
y = Perc_per_hour))+
geom_boxplot(aes(fill = network,
color = network),
position = position_dodge2(preserve = "single"),
alpha = 0.5,
width = 0.25)+
scale_fill_viridis_d(end = 0.75,
direction = -1,
guide = "none")+
scale_color_viridis_d(end = 0.75,
direction = -1,
guide = "none")+
facet_grid(rows = vars(npz_id),
scales = "free_x",
space = "free",
drop = TRUE) +
labs(x = "Weekday",
y = "Proportion hours per day with vessels") +
theme(
strip.text.y = element_text(face = "bold"),
axis.text.x = element_text(face = "bold")
)
# Plot proportion of hours present per day
ggplot(data = all_ves_prop_hrs_day |>
# only want to plot presence
filter(ves_yn == "Y"),
aes(x = Weekday,
y = Perc_per_hour))+
geom_boxplot(aes(fill = network,
color = network),
position = position_dodge2(preserve = "single"),
alpha = 0.5,
width = 0.25)+
scale_fill_viridis_d(end = 0.75,
direction = -1,
guide = "none")+
scale_color_viridis_d(end = 0.75,
direction = -1,
guide = "none")+
facet_grid(rows = vars(npz_id),
cols = vars(network),
scales = "free_x",
space = "free",
drop = TRUE) +
labs(x = "Weekday",
y = "Proportion hours per day with vessels") +
theme(
strip.text.y = element_text(face = "bold"),
axis.text.x = element_text(face = "bold")
)
# Plot proportion of hours present per day
ggplot(data = all_ves_prop_hrs_day |>
# only want to plot presence
filter(ves_yn == "Y"),
aes(x = Weekday,
y = Perc_per_hour))+
geom_boxplot(aes(fill = network,
color = network),
position = position_dodge2(preserve = "single"),
alpha = 0.5,
width = 0.25)+
scale_fill_viridis_d(end = 0.75,
direction = -1,
guide = "none")+
scale_color_viridis_d(end = 0.75,
direction = -1,
guide = "none")+
facet_grid(rows = vars(npz_id),
cols = vars(network),
scales = "free",
space = "free",
drop = TRUE) +
labs(x = "Weekday",
y = "Proportion hours per day with vessels") +
theme(
strip.text.y = element_text(face = "bold"),
axis.text.x = element_text(face = "bold")
)
# Plot proportion of hours present per day
ggplot(data = all_ves_prop_hrs_day |>
# only want to plot presence
filter(ves_yn == "Y"),
aes(x = Weekday,
y = Perc_per_hour))+
geom_boxplot(aes(fill = network,
color = network),
position = position_dodge2(preserve = "single"),
alpha = 0.5,
width = 0.25)+
scale_fill_viridis_d(end = 0.75,
direction = -1,
guide = "none")+
scale_color_viridis_d(end = 0.75,
direction = -1,
guide = "none")+
facet_grid(rows = vars(npz_id),
cols = vars(network),
scales = "free_x",
space = "free",
drop = TRUE) +
labs(x = "Weekday",
y = "Proportion hours per day with vessels") +
theme(
strip.text.y = element_text(face = "bold"),
axis.text.x = element_text(face = "bold")
)
weekday_summary |> all_ves_prop_hrs_day |>
group_by(Dep, Weekday) |>
summarize(ndays = n(),
prop_median = median(Perc_per_hour))
weekday_summary <- all_ves_prop_hrs_day |>
group_by(Dep, Weekday) |>
summarize(ndays = n(),
prop_median = median(Perc_per_hour))
all_ves_prop_hrs_day <- all_sites_hp |>
# group by y/n column
group_by(network, npz_id, Site_ID, Dep, Date_week, Weekday, Begin_Date_loc,
ves_yn) |>
# get total number of hours for Y and N groups per each hour per deployment
summarize(n_hours = n())|>
mutate(freq = n_hours/sum(n_hours)) |>
ungroup() |>
complete(Site_ID, ves_yn,
fill = list(ves_yn = "Y", freq = 0)) |>
group_by(Site_ID, ves_yn) |>
# reshape for easier plotting
pivot_longer(cols = c("freq"),
values_to = "Perc_per_hour") |>
mutate(network = factor(network, levels = c("Temperate East","Northwest","South-west"))) |>
mutate(Weekday = factor(Weekday, levels=c("Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday")),
network = case_when(Site_ID == "CG" | Site_ID == "EP" | Site_ID == "WP" ~ "Temperate East",
Site_ID == "DNE" | Site_ID == "DSW" | Site_ID == "NGN"| Site_ID == "NGS" ~ "Northwest",
TRUE ~ "South-west"
),
network = fct(network),
network = fct_relevel(network, c("Temperate East","Northwest")),
npz_id = fct_relevel(npz_id, c("CGMP","SIMP","DMP","NMP")))
levels(all_ves_prop_hrs_day$Weekday) <- c("M","T","W","R","F","Sa","Su")
all_ves_prop_hrs_day <- all_sites_hp |>
# group by y/n column
group_by(network, npz_id, Site_ID, Dep, Date_week, Weekday, Begin_Date_loc,
ves_yn) |>
# get total number of hours for Y and N groups per each hour per deployment
summarize(n_hours = n())|>
mutate(freq = n_hours/sum(n_hours)) |>
ungroup() |>
complete(Site_ID, ves_yn,
fill = list(ves_yn = "Y", freq = 0)) |>
group_by(Site_ID, ves_yn) |>
# reshape for easier plotting
pivot_longer(cols = c("freq"),
values_to = "Perc_per_hour") |>
mutate(network = factor(network, levels = c("Temperate East","Northwest","South-west"))) |>
mutate(Weekday = factor(Weekday, levels=c("Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday")),
network = case_when(Site_ID == "CG" | Site_ID == "EP" | Site_ID == "WP" ~ "Temperate East",
Site_ID == "DNE" | Site_ID == "DSW" | Site_ID == "NGN"| Site_ID == "NGS" ~ "Northwest",
TRUE ~ "South-west"
),
network = fct(network),
network = fct_relevel(network, c("Temperate East","Northwest")),
npz_id = fct_relevel(npz_id, c("CGMP","SIMP","DMP","NMP")))
all_ves_prop_hrs_day <- all_sites_hp |>
# group by y/n column
group_by(network, npz_id, Site_ID, Dep, Date_week, Weekday, Begin_Date_loc,
ves_yn) |>
# get total number of hours for Y and N groups per each hour per deployment
summarize(n_hours = n())|>
mutate(freq = n_hours/sum(n_hours)) |>
ungroup() |>
complete(Site_ID, ves_yn,
fill = list(ves_yn = "Y", freq = 0)) |>
group_by(Site_ID, ves_yn) |>
# reshape for easier plotting
pivot_longer(cols = c("freq"),
values_to = "Perc_per_hour") |>
mutate(network = factor(network, levels = c("Temperate East","Northwest","South-west"))) |>
mutate(Weekday = factor(Weekday, levels=c("Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday")),
network = case_when(Site_ID == "CG" | Site_ID == "EP" | Site_ID == "WP" ~ "Temperate East",
Site_ID == "DNE" | Site_ID == "DSW" | Site_ID == "NGN"| Site_ID == "NGS" ~ "Northwest",
TRUE ~ "South-west"
),
network = fct(network),
network = fct_relevel(network, c("Temperate East","Northwest")),
npz_id = fct(npz_id),
npz_id = fct_relevel(npz_id, c("CGMP","SIMP","DMP","NMP")))
# Plot proportion of hours present per day by weekday
ggplot(data = all_ves_prop_hrs_day |>
# only want to plot presence
filter(ves_yn == "Y"),
aes(x = Weekday,
y = Perc_per_hour))+
geom_boxplot(aes(fill = network,
color = network),
position = position_dodge2(preserve = "single"),
alpha = 0.5,
width = 0.25)+
scale_fill_viridis_d(end = 0.75,
direction = -1,
guide = "none")+
scale_color_viridis_d(end = 0.75,
direction = -1,
guide = "none")+
facet_grid(rows = vars(npz_id),
cols = vars(network),
scales = "free_x",
space = "free",
drop = TRUE) +
labs(x = "Weekday",
y = "Proportion hours per day with vessels") +
theme(
strip.text.y = element_text(face = "bold"),
axis.text.x = element_text(face = "bold")
)
# Plot proportion of hours present per day by weekday
ggplot(data = all_ves_prop_hrs_day |>
# only want to plot presence
filter(ves_yn == "Y"),
aes(x = Weekday,
y = Perc_per_hour))+
geom_boxplot(aes(fill = network,
color = network),
position = position_dodge2(preserve = "single"),
alpha = 0.5,
width = 0.25)+
scale_fill_viridis_d(end = 0.75,
direction = -1,
guide = "none")+
scale_color_viridis_d(end = 0.75,
direction = -1,
guide = "none")+
facet_grid(rows = vars(npz_id),
# cols = vars(network),
scales = "free_x",
space = "free",
drop = TRUE) +
labs(x = "Weekday",
y = "Proportion hours per day with vessels") +
theme(
strip.text.y = element_text(face = "bold"),
axis.text.x = element_text(face = "bold")
)
# Plot proportion of hours present per day by weekday
ggplot(data = all_ves_prop_hrs_day |>
# only want to plot presence
filter(ves_yn == "Y"),
aes(x = Weekday,
y = Perc_per_hour))+
geom_boxplot(aes(fill = network,
color = network),
position = position_dodge2(preserve = "single"),
alpha = 0.5,
width = 0.25)+
scale_fill_viridis_d(end = 0.75,
direction = -1,
guide = "none")+
scale_color_viridis_d(end = 0.75,
direction = -1,
guide = "none")+
facet_grid(network~npz_id
scales = "free_x",
# Plot proportion of hours present per day by weekday
ggplot(data = all_ves_prop_hrs_day |>
# only want to plot presence
filter(ves_yn == "Y"),
aes(x = Weekday,
y = Perc_per_hour))+
geom_boxplot(aes(fill = network,
color = network),
position = position_dodge2(preserve = "single"),
alpha = 0.5,
width = 0.25)+
scale_fill_viridis_d(end = 0.75,
direction = -1,
guide = "none")+
scale_color_viridis_d(end = 0.75,
direction = -1,
guide = "none")+
facet_grid(network~npz_id,
scales = "free_x",
space = "free",
drop = TRUE) +
labs(x = "Weekday",
y = "Proportion hours per day with vessels") +
theme(
strip.text.y = element_text(face = "bold"),
axis.text.x = element_text(face = "bold")
)
# Plot proportion of hours present per day by weekday
ggplot(data = all_ves_prop_hrs_day |>
# only want to plot presence
filter(ves_yn == "Y"),
aes(x = Weekday,
y = Perc_per_hour))+
geom_boxplot(aes(fill = network,
color = network),
position = position_dodge2(preserve = "single"),
alpha = 0.5,
width = 0.25)+
scale_fill_viridis_d(end = 0.75,
direction = -1,
guide = "none")+
scale_color_viridis_d(end = 0.75,
direction = -1,
guide = "none")+
facet_grid(network~npz_id,
# scales = "free_x",
# space = "free",
drop = TRUE) +
labs(x = "Weekday",
y = "Proportion hours per day with vessels") +
theme(
strip.text.y = element_text(face = "bold"),
axis.text.x = element_text(face = "bold")
)
