scale_fill_manual(values = c("over" = "deepskyblue",
"under" = "orange",
"center" = "grey75"))+
scale_y_continuous(limits = c(-1.5,2.5))+
labs(y = "",
x = "Weekday")+
facet_nested(rows = vars(npz_id, Dep_ID),
# cols = vars(network),
nest_line = element_line(),
scales = "fixed") +
theme(
axis.text.x = element_text(face = "bold"),
strip.background = element_blank(),
strip.text.y = element_text(face = "bold"),
plot.margin = margin(t = 20, r = 5.5, b = 356)
)
ggarrange(wkdy_plot_man_tempeast, wkdy_plot_man_northwest, wkdy_plot_man_southwest,
nrow = 1,
labels = c("Temperate East","Northwest","South-west"),
vjust=1.25)
qqnorm(wkly_means_tot$mean_wkdy_adj)
qqnorm(wkly_means_ins_man$mean_wkdy_adj)
qqnorm(wkly_means_ins_man$mean_man_wkdy_adj)
qqplot(wkly_means_ins_man$mean_man_wkdy_adj)
glm_test <- lm(mean_wkdy_adj ~ Weekday + Dep_ID, data = wkly_means_tot)
check_model(glm_test)
library(readr)
library(tidyverse)
library(broom) # looking at model results
library(performance) # model performance
library(modelr)
# for fitting
library(betareg)
library(glmmTMB)
library(lme4) # fitting mixed models
# simulate residuals
library(DHARMa)
# for viz
library(ggplot2)
theme_set(theme_classic(base_size = 14))
check_model(glm_test)
check_model(glm_test)
summary(glm_test)
View(wkly_means_tot)
View(wkly_means_ins)
glm_test <- lm(mean_wkdy_adj ~ Weekday + Dep_ID + Weekday*Dep_ID, data = wkly_means_tot)
summary(glm_test)
wkly_means_tot <- wkly_means_tot |> mutate(npz_dep = paste0(npz_id, Dep_ID))
glm_test <- lm(mean_wkdy_adj ~ Weekday + npz_dep + Weekday*npz_dep, data = wkly_means_tot)
summary(glm_test)
View(wkly_means_tot)
wkly_means_tot <- wkly_means_tot |> mutate(npz_dep = paste0(npz_id, Dep_ID), npz_dep = as_factor(npz_dep))
glm_test <- lm(mean_wkdy_adj ~ Weekday + npz_dep + Weekday*npz_dep, data = wkly_means_tot)
summary(glm_test)
glm_test <- lm(mean_wkdy_adj ~ Weekday + npz_dep, data = wkly_means_tot)
summary(glm_test)
glm_test <- lm(mean_wkdy_adj ~ Weekday*npz_dep, data = wkly_means_tot)
summary(glm_test)
wkly_means_tot <- all_ves_wkdy |>
# group to week level
group_by(network, npz_id, Dep_ID, Dep, Date_week) |>
# get n_days per week in dataset
summarize(n_days = n(),
week_sum = sum(Total_ves_dep, na.rm = TRUE)) |>
# only keep full weeks n_days == 7
# only keep weeks with presence
filter(n_days == 7,
week_sum > 0) |>
# get original weekday counts
left_join(all_ves_wkdy) |>
# re-group to week level
group_by(network, npz_id, Dep_ID, Dep, Date_week) |>
# calculate weekly mean of total presence for days with presence
mutate(mean_tot = mean(Total_ves_dep, na.rm = TRUE),
# calculate mean-adjusted counts per weekday
tot_wkdy_adj = Total_ves_dep - mean_tot)
wkly_means_tot <- wkly_means_tot |> mutate(npz_dep = paste0(npz_id, Dep_ID), npz_dep = as_factor(npz_dep))
glm_test <- lm(tot_wkdy_adj ~ Weekday*npz_dep, data = wkly_means_tot)
glm_test <- lm(tot_wkdy_adj ~ Weekday + npz_dep + Weekday*npz_dep, data = wkly_means_tot)
summary(glm_test)
check_model(glm_test)
check_autocorrelation()
check_autocorrelation(glm_test)
aov_test <- aov(tot_wkdy_adj ~ Weekday*npz_dep, data = wkly_means_tot)
summary(aov_test)
aov_test <- aov(tot_wkdy_adj ~ Weekday*npz_dep, data = wkly_means_tot)
summary(aov_test)
means_wkdy <- wkly_means_tot |> group_by(npz_dep) |> summarise(mean(tot_wkdy_adj))
means_wkdy
means_wkdy <- wkly_means_tot |> group_by(Weekday) |> summarise(mean(tot_wkdy_adj))
means_wkdy
check_model(aov_test)
?check_model
check_model(aov_test)
check_model(glm_test)
summary(glm_test)
summary(glm_test)
# start by getting hourly counts
all_ves_diel <- all_sites_hp |>
group_by(network, npz_id, Dep_ID, Dep, Begin_Date_loc, Begin_Hour_loc)|>
# get daily vessel counts per weekday: total, inside, inside_small, maneuver, maneuver_small
summarise(Total_ves_dep = sum(Total_Vessels, na.rm = TRUE),
Total_inside = sum(total_inside, na.rm = TRUE),
Total_inside_small = sum(total_inside_small, na.rm = TRUE),
Inside_maneuver = sum(man_inside, na.rm = TRUE),
Inside_maneuver_small = sum(man_inside_small, na.rm = TRUE)) |>
mutate(Inside_transit = Total_inside - Inside_maneuver,
Inside_transit_small = Total_inside_small - Inside_maneuver_small,
network = case_when(npz_id == "CGMP" | npz_id == "SIMP" ~ "Temperate East",
npz_id == "DMP" | npz_id == "NMP" ~ "Northwest", TRUE ~ "South-west"
),
network = factor(network, levels = c("Temperate East","Northwest","South-west")))
# Calculate daily mean-adjusted counts per hour
daily_means_tot <- all_ves_diel |>
# group to date level
group_by(network, npz_id, Dep_ID, Dep, Begin_Date_loc) |>
# get n_hours per day
summarize(n_hrs = n(),
# and total vessels per day
day_sum = sum(Total_ves_dep, na.rm = TRUE)) |>
# only keep full days n_hrs == 24
# and days with vessels present
filter(n_hrs == 24,
day_sum >0) |>
# join to get hourly counts back
left_join(all_ves_diel) |>
# re-group to daily level
group_by(network, npz_id, Dep_ID, Dep, Begin_Date_loc) |>
# calculate mean total presence per day with vessels
mutate(mean_tot = mean(Total_ves_dep, na.rm = TRUE),
# calculate mean-adjusted counts per hour
tot_diel_adj = Total_ves_dep - mean_tot) |>
# group to hour level per deployment
group_by(network, npz_id, Dep_ID, Begin_Hour_loc) |>
# get mean of mean-adjusted ounts per hour
summarise(mean_diel_adj = mean(tot_diel_adj, na.rm =TRUE)) |>
# get lower & upper bounds for SD around mean of adjusted counts
mutate(sd_lower = mean_diel_adj - 0.5*(sd(mean_diel_adj)),
sd_upper = mean_diel_adj + 0.5*(sd(mean_diel_adj)))
# Calculate daily mean-adjusted counts per hour for inside vessels
daily_means_ins <- all_ves_diel |>
# group to date level
group_by(network, npz_id, Dep_ID, Dep, Begin_Date_loc) |>
# get n_hours per day
summarize(n_hrs = n(),
# and total vessels per day
day_sum = sum(Total_inside, na.rm = TRUE)) |>
# only keep full days n_hrs == 24
# and days with vessels present
filter(n_hrs == 24,
day_sum > 0) |>
# join to get hourly counts back
left_join(all_ves_diel) |>
# re-group to daily level
group_by(network, npz_id, Dep_ID, Dep, Begin_Date_loc) |>
# calculate mean total presence per day with vessels
mutate(mean_ins = mean(Total_inside, na.rm = TRUE),
# calculate mean-adjusted counts per hour
ins_diel_adj = Total_inside - mean_ins) |>
# group to hour level per deployment
group_by(network, npz_id, Dep_ID, Begin_Hour_loc) |>
# get mean of mean-adjusted ounts per hour
summarise(mean_diel_adj = mean(ins_diel_adj, na.rm =TRUE)) |>
# get lower & upper bounds for SD around mean of adjusted counts
mutate(sd_lower = mean_diel_adj - 0.5*(sd(mean_diel_adj)),
sd_upper = mean_diel_adj + 0.5*(sd(mean_diel_adj)))
# Calculate diel mean-adusted counts for maneuvers
daily_means_ins_man <- all_ves_diel |>
# group to date level
group_by(network, npz_id, Dep_ID, Dep, Begin_Date_loc) |>
# get n_hours per day
summarize(n_hrs = n(),
# and total vessels per day
day_sum = sum(Inside_maneuver, na.rm = TRUE)) |>
# only keep full days n_hrs == 24
# and days with vessels present
filter(n_hrs == 24,
day_sum > 0) |>
# join to get hourly counts back
left_join(all_ves_diel) |>
# re-group to daily level
group_by(network, npz_id, Dep_ID, Dep, Begin_Date_loc) |>
# calculate mean total presence per day with vessels
mutate(mean_ins_man = mean(Inside_maneuver, na.rm = TRUE),
# calculate mean-adjusted counts per hour
ins_diel_man_adj = Inside_maneuver - mean_ins_man) |>
# group to hour level per deployment
group_by(network, npz_id, Dep_ID, Begin_Hour_loc) |>
# get mean of mean-adjusted ounts per hour
summarise(mean_diel_man_adj = mean(ins_diel_man_adj, na.rm =TRUE)) |>
# get lower & upper bounds for SD around mean of adjusted counts
mutate(sd_lower = mean_diel_man_adj - 0.5*(sd(mean_diel_man_adj)),
sd_upper = mean_diel_man_adj + 0.5*(sd(mean_diel_man_adj)))
# Calculate daily mean-adjusted counts per hour
daily_means_tot <- all_ves_diel |>
# group to date level
group_by(network, npz_id, Dep_ID, Dep, Begin_Date_loc) |>
# get n_hours per day
summarize(n_hrs = n(),
# and total vessels per day
day_sum = sum(Total_ves_dep, na.rm = TRUE)) |>
# only keep full days n_hrs == 24
# and days with vessels present
filter(n_hrs == 24,
day_sum >0) |>
# join to get hourly counts back
left_join(all_ves_diel) |>
# re-group to daily level
group_by(network, npz_id, Dep_ID, Dep, Begin_Date_loc) |>
# calculate mean total presence per day with vessels
mutate(mean_tot = mean(Total_ves_dep, na.rm = TRUE),
# calculate mean-adjusted counts per hour
tot_diel_adj = Total_ves_dep - mean_tot)
daily_means_tot <- daily_means_tot |> mutate(npz_dep = as_factor(paste0(npz_id, Dep_ID)))
lm_daily <- lm(tot_diel_adj ~ Begin_Hour_loc+npz_dep + Begin_Hour_loc*npz_dep, data = daily_means_tot)
check_model(lm_daily)
check_autocorrelation(lm_daily)
tidy(lm_daily)
tidy(lm_daily, print(n = 26))
tidy(lm_daily)
summary(lm_daily)
daily_means_tot <- daily_means_tot |> mutate(npz_dep = as_factor(paste0(npz_id, Dep_ID)), Begin_Hour_loc = as_factor(Begin_Hour_loc))
lm_daily <- lm(tot_diel_adj ~ Begin_Hour_loc+npz_dep + Begin_Hour_loc*npz_dep, data = daily_means_tot)
check_model(lm_daily)
summary(lm_daily)
# Weekly mean-adjusted counts for total vessels
wkly_mean_adj_tot <- all_ves_wkdy |>
# group to week level
group_by(network, npz_id, Dep_ID, Dep, Date_week) |>
# get n_days per week in dataset
summarize(n_days = n(),
week_sum = sum(Total_ves_dep, na.rm = TRUE)) |>
# only keep full weeks n_days == 7
# only keep weeks with presence
filter(n_days == 7,
week_sum > 0) |>
# get original weekday counts
left_join(all_ves_wkdy) |>
# re-group to week level
group_by(network, npz_id, Dep_ID, Dep, Date_week) |>
# calculate weekly mean of total presence for days with presence
mutate(mean_tot = mean(Total_ves_dep, na.rm = TRUE),
# calculate mean-adjusted counts per weekday
tot_wkdy_adj = Total_ves_dep - mean_tot)
# summarize mean & SD for plots
wkly_means_tot <- wkly_mean_adj_tot |>
group_by(network, npz_id, Dep_ID, Weekday) |>
# get mean of mean-adjusted counts for each weekday
summarise(mean_wkdy_adj = mean(tot_wkdy_adj, na.rm = TRUE)) |>
# get lower & upper bounds of SD of the mean of the adjusted counts
mutate(sd_lower = mean_wkdy_adj - 0.5*(sd(mean_wkdy_adj)),
sd_upper = mean_wkdy_adj + 0.5*(sd(mean_wkdy_adj)))
# start by getting daily counts
all_ves_wkdy <- all_sites_hp |>
group_by(network, npz_id, Dep_ID, Dep, Date_week, Weekday, Begin_Date_loc)|>
# get daily vessel counts per weekday: total, inside, inside_small, maneuver, maneuver_small
summarise(Total_ves_dep = sum(Total_Vessels, na.rm = TRUE),
Total_inside = sum(total_inside, na.rm = TRUE),
Total_inside_small = sum(total_inside_small, na.rm = TRUE),
Inside_maneuver = sum(man_inside, na.rm = TRUE),
Inside_maneuver_small = sum(man_inside_small, na.rm = TRUE)) |>
mutate(Inside_transit = Total_inside - Inside_maneuver,
Inside_transit_small = Total_inside_small - Inside_maneuver_small,
Weekday = factor(Weekday, levels=c("Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday")),
network = case_when(npz_id == "CGMP" | npz_id == "SIMP" ~ "Temperate East",
npz_id == "DMP" | npz_id == "NMP" ~ "Northwest", TRUE ~ "South-west"
),
network = factor(network, levels = c("Temperate East","Northwest","South-west")))
levels(all_ves_wkdy$Weekday) <- c("M","T","W","Th","F","Sa","Su")
# Weekly mean-adjusted counts for total vessels
wkly_mean_adj_tot <- all_ves_wkdy |>
# group to week level
group_by(network, npz_id, Dep_ID, Dep, Date_week) |>
# get n_days per week in dataset
summarize(n_days = n(),
week_sum = sum(Total_ves_dep, na.rm = TRUE)) |>
# only keep full weeks n_days == 7
# only keep weeks with presence
filter(n_days == 7,
week_sum > 0) |>
# get original weekday counts
left_join(all_ves_wkdy) |>
# re-group to week level
group_by(network, npz_id, Dep_ID, Dep, Date_week) |>
# calculate weekly mean of total presence for days with presence
mutate(mean_tot = mean(Total_ves_dep, na.rm = TRUE),
# calculate mean-adjusted counts per weekday
tot_wkdy_adj = Total_ves_dep - mean_tot)
# summarize mean & SD for plots
wkly_means_tot <- wkly_mean_adj_tot |>
group_by(network, npz_id, Dep_ID, Weekday) |>
# get mean of mean-adjusted counts for each weekday
summarise(mean_wkdy_adj = mean(tot_wkdy_adj, na.rm = TRUE)) |>
# get lower & upper bounds of SD of the mean of the adjusted counts
mutate(sd_lower = mean_wkdy_adj - 0.5*(sd(mean_wkdy_adj)),
sd_upper = mean_wkdy_adj + 0.5*(sd(mean_wkdy_adj)))
# Weekly mean-adjusted counts, inside vessels
wkly_mean_adj_ins <- all_ves_wkdy |>
# group to week level
group_by(network, npz_id, Dep_ID, Dep, Date_week) |>
# get n_days per week in dataset
summarize(n_days = n(),
week_sum = sum(Total_inside, na.rm = TRUE)) |>
# only keep full weeks n_days == 7
# only keep weeks with presence inside
filter(n_days == 7,
week_sum > 0) |>
# get original weekday counts
left_join(all_ves_wkdy) |>
# re-group to week level
group_by(network, npz_id, Dep_ID, Dep, Date_week) |>
# calculate weekly mean of total presence inside for days with presence inside
mutate(mean_tot = mean(Total_inside, na.rm = TRUE),
# calculate mean-adjusted counts per weekday
tot_wkdy_adj = Total_inside - mean_tot)
wkly_means_ins <- wkly_mean_adj_ins |>
group_by(network, npz_id, Dep_ID, Weekday) |>
# get mean of mean-adjusted counts for each weekday
summarise(mean_wkdy_adj = mean(tot_wkdy_adj, na.rm = TRUE)) |>
# get lower & upper bounds of SD of the mean of the adjusted counts
mutate(sd_lower = mean_wkdy_adj - 0.5*(sd(mean_wkdy_adj)),
sd_upper = mean_wkdy_adj + 0.5*(sd(mean_wkdy_adj)))
# Weekly mean-adjusted counts, maneuvers
wkly_mean_adj_ins_man <- all_ves_wkdy |>
# group to week level
group_by(network, npz_id, Dep_ID, Dep, Date_week) |>
# get n_days per week in dataset
summarize(n_days = n(),
week_sum = sum(Inside_maneuver, na.rm = TRUE)) |>
# only keep full weeks n_days == 7
# only keep weeks with presence of maneuvers
filter(n_days == 7,
week_sum > 0) |>
# get original weekday counts
left_join(all_ves_wkdy) |>
# re-group to week level
group_by(network, npz_id, Dep_ID, Dep, Date_week) |>
# calculate weekly mean of total presence for days with presence of maneuvers
mutate(mean_man = mean(Inside_maneuver, na.rm = TRUE),
# calculate mean-adjusted counts per weekday
man_wkdy_adj = Inside_maneuver - mean_man)
wkly_means_ins_man <- wkly_mean_adj_ins_man |>
group_by(network, npz_id, Dep_ID, Weekday) |>
# get mean of mean-adjusted counts for each weekday
summarise(mean_man_wkdy_adj = mean(man_wkdy_adj, na.rm = TRUE)) |>
# get lower & upper bounds of SD of the mean of the adjusted counts
mutate(man_sd_lower = mean_man_wkdy_adj - 0.5*(sd(mean_man_wkdy_adj)),
man_sd_upper = mean_man_wkdy_adj + 0.5*(sd(mean_man_wkdy_adj)))
wkly_mean_adj_tot <- wkly_mean_adj_tot |>
mutate(npz_dep = as_factor(paste0(npz_id, Dep_ID)))
# 2-way ANOVA deployment + Weekday
week_aov <- aov(tot_wkdy_adj ~ npz_dep + Weekday,
data = wkly_mean_adj_tot)
tidy(week_aov)
summary(week_aov)
# 2-way ANOVA deployment*Weekday
week_aov <- aov(tot_wkdy_adj ~ npz_dep*Weekday,
data = wkly_mean_adj_tot)
# 2-way ANOVA deployment + Weekday
week_aov <- aov(tot_wkdy_adj ~ npz_dep + Weekday,
data = wkly_mean_adj_tot)
# 2-way ANOVA deployment*Weekday
week_aov_int <- aov(tot_wkdy_adj ~ npz_dep*Weekday,
data = wkly_mean_adj_tot)
summary(week_aov_int)
AIC(week_aov)
AIC(week_aov_int)
install.packages("MuMIn")
library(MuMIn)
AICc(c(week_aov, week_aov_int))
AICc(week_aov, week_aov_int)
# 2-way ANOVA deployment*weekday + network
week_aov_int_net <- aov(tot_wkdy_adj ~ npz_dep*Weekday + network,
data = wkly_mean_adj_tot)
AICc(week_aov, week_aov_int, week_aov_int_net)
wkly_mean_adj_ins <- wkly_mean_adj_ins |>
mutate(npz_dep = as_factor(paste0(npz_id, Dep_ID)))
# 2-way ANOVA deployment + Weekday
week_ins_aov <- aov(tot_wkdy_adj ~ npz_dep + Weekday,
data = wkly_mean_adj_ins)
# 2-way ANOVA deployment*Weekday
week_ins_aov_int <- aov(tot_wkdy_adj ~ npz_dep*Weekday,
data = wkly_mean_adj_ins)
AICc(week_ins_aov, week_ins_aov_int)
check_model(weeK_ins_aov)
check_model(week_ins_aov)
check_model(week_aov)
summary(week_ins_aov)
wkly_mean_adj_ins_man <- wkly_mean_adj_ins_man |>
mutate(npz_dep = as_factor(paste0(npz_id, Dep_ID)))
# 2-way ANOVA deployment + Weekday
week_man_aov <- aov(man_wkdy_adj ~ npz_dep + Weekday,
data = wkly_mean_adj_ins_man)
# 2-way ANOVA deployment*Weekday
week_man_aov_int <- aov(man_wkdy_adj ~ npz_dep*Weekday,
data = wkly_mean_adj_ins_man)
AICc(week_man_aov, week_man_aov_int)
summary(week_man_aov)
TukeyHSD(week_man_aov)
check_model(week_man_aov)
TukeyHSD(week_man_aov)
TukeyHSD(week_ins_aov)
TukeyHSD(week_aov)
TukeyHSD(week_man_aov_int)
week_glm <- glm(tot_wkdy_adj ~ npz_dep + Weekday,
data = wkly_mean_adj_tot)
check_model(week_glm)
week_glm_int <- glm(tot_wkdy_adj ~ npz_dep*Weekday,
data = wkly_mean_adj_tot)
AICc(week_aov, week_aov_int, week_glm, week_glm_int)
week_glm_int <- glm(tot_wkdy_adj ~ npz_dep*Weekday + network,
data = wkly_mean_adj_tot)
AICc(week_aov, week_aov_int, week_glm, week_glm_int)
week_glm_int <- glmmTMB(tot_wkdy_adj ~ npz_dep*Weekday | network,
data = wkly_mean_adj_tot)
week_glm_int <- glmmTMB(tot_wkdy_adj ~ npz_dep*Weekday + (1|network),
data = wkly_mean_adj_tot)
AICc(week_aov, week_aov_int, week_glm, week_glm_int)
week_glm_int <- glmmTMB(tot_wkdy_adj ~ npz_dep*Weekday + (1|npz_id),
data = wkly_mean_adj_tot)
AICc(week_aov, week_aov_int, week_glm, week_glm_int)
week_glm_int <- glmmTMB(tot_wkdy_adj ~ npz_id*Weekday,
data = wkly_mean_adj_tot)
AICc(week_aov, week_aov_int, week_glm, week_glm_int)
week_glm_int <- glmmTMB(tot_wkdy_adj ~ npz_dep*Weekday,
data = wkly_mean_adj_tot)
AICc(week_aov, week_aov_int, week_glm, week_glm_int)
summary(week_glm)
wkly_mean_adj_tot <- wkly_mean_adj_tot |>
mutate(npz_dep = as_factor(paste0(npz_id, Dep_ID)))
# deployment + Weekday
week_aov <- aov(tot_wkdy_adj ~ npz_dep + Weekday,
data = wkly_mean_adj_tot)
# total counts
wkly_mean_adj_tot <- wkly_mean_adj_tot |>
mutate(npz_dep = as_factor(paste0(npz_id, Dep_ID)))
# deployment + Weekday
week_aov <- aov(tot_wkdy_adj ~ npz_dep + Weekday,
data = wkly_mean_adj_tot)
# deployment*Weekday
week_aov_int <- aov(tot_wkdy_adj ~ npz_dep*Weekday,
data = wkly_mean_adj_tot)
AICc(week_aov, week_aov_int)
# inside vessels
wkly_mean_adj_ins <- wkly_mean_adj_ins |>
mutate(npz_dep = as_factor(paste0(npz_id, Dep_ID)))
# 2-way ANOVA deployment + Weekday
week_ins_aov <- aov(tot_wkdy_adj ~ npz_dep + Weekday,
data = wkly_mean_adj_ins)
# 2-way ANOVA deployment*Weekday
week_ins_aov_int <- aov(tot_wkdy_adj ~ npz_dep*Weekday,
data = wkly_mean_adj_ins)
AICc(week_ins_aov, week_ins_aov_int)
#                  df     AICc
# week_ins_aov     18 1689.987
# week_ins_aov_int 78 1738.303
# maneuvers
wkly_mean_adj_ins_man <- wkly_mean_adj_ins_man |>
mutate(npz_dep = as_factor(paste0(npz_id, Dep_ID)))
# 2-way ANOVA deployment + Weekday
week_man_aov <- aov(man_wkdy_adj ~ npz_dep + Weekday,
data = wkly_mean_adj_ins_man)
# 2-way ANOVA deployment*Weekday
week_man_aov_int <- aov(man_wkdy_adj ~ npz_dep*Weekday,
data = wkly_mean_adj_ins_man)
AICc(week_man_aov, week_man_aov_int)
summary(week_aov)
TukeyHSD(week_aov)
tidy(week_aov)
tukey_week <- TukeyHSD(week_aov)
tidy(tukey_week)
tukey_week
tukey_week <- tidy(TukeyHSD(week_aov)) |>
filter(adj.p.value <= 0.05)
tukey_week
tukey_week_int <- tidy(TukeyHSD(week_aov_int)) |>
filter(adj.p.value <= 0.05)
tukey_week_int
View(tukey_week_int)
tukey_week_ins <- tidy(TukeyHSD(week_ins_aov)) |>
filter(adj.p.value <= 0.05)
tukey_week_ins
View(tukey_week_ins)
# 2-way ANOVA deployment + Weekday
week_ins_aov <- aov(tot_wkdy_adj ~ npz_dep + Weekday,
data = wkly_mean_adj_ins)
tidy(week_ins_aov)
TukeyHSD(week_ins_aov)
# maneuvers
wkly_mean_adj_ins_man <- wkly_mean_adj_ins_man |>
mutate(npz_dep = as_factor(paste0(npz_id, Dep_ID)))
# 2-way ANOVA deployment + Weekday
week_man_aov <- aov(man_wkdy_adj ~ npz_dep + Weekday,
data = wkly_mean_adj_ins_man)
# 2-way ANOVA deployment*Weekday
week_man_aov_int <- aov(man_wkdy_adj ~ npz_dep*Weekday,
data = wkly_mean_adj_ins_man)
AICc(week_man_aov, week_man_aov_int)
tukey_week_man <- tidy(TukeyHSD(week_man_aov)) |>
filter(adj.p.value <= 0.05)
View(tukey_week_man)
tukey_week <- tidy(TukeyHSD(week_aov)) |>
filter(adj.p.value <= 0.10)
tukey_week_ins <- tidy(TukeyHSD(week_ins_aov)) |>
filter(adj.p.value <= 0.10)
tukey_week_man <- tidy(TukeyHSD(week_man_aov)) |>
filter(adj.p.value <= 0.10)
View(tukey_week_ins)
View(tukey_week_int)
View(tukey_week_ins)
View(tukey_week)
View(tukey_week_man)
