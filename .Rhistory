alpha = 0.5,
width = 0.5)+
# geom_point(aes(group = Dep),
#            alpha = 0.5,
#            position = position_jitterdodge(dodge.width = 0.25,
#                                            jitter.width = 0)) +
scale_fill_viridis_d(end = 0.75,
direction = -1,
guide = "none")+
scale_color_viridis_d(end = 0.75,
direction = -1,
guide = "none")+
facet_grid(~network,
scales = "free_x",
space = "free",
drop = TRUE) +
labs(x = "NPZ",
y = "Proportion hours per week with vessels") +
theme(
strip.text.x = element_text(face = "bold"),
axis.text.x = element_text(face = "bold")
)
# Try to plot!
ggplot(data = ins_ves_prop_hrs |> filter(ins_ves_yn == "Y"),
aes(x = npz_id,
y = Perc_per_hour,
fill = network,
color = network))+
geom_boxplot(aes(group = Dep),
position = position_dodge2(preserve = "single"),
alpha = 0.5,
width = 0.5)+
# geom_point(aes(group = Dep),
#            alpha = 0.5,
#            position = position_jitterdodge(dodge.width = 0.25,
#                                            jitter.width = 0)) +
scale_fill_viridis_d(end = 0.75,
direction = -1,
guide = "none")+
scale_color_viridis_d(end = 0.75,
direction = -1,
guide = "none")+
facet_grid(~network,
scales = "free_x",
space = "free",
drop = TRUE) +
labs(x = "NPZ",
y = "Proportion hours per week with \nvessels inside park") +
theme(
strip.text.x = element_text(face = "bold"),
axis.text.x = element_text(face = "bold")
)
ins_ves_prop_hrs <- all_sites_hp |>
# group by y/n column to collapse into hours
group_by(network, npz_id, Site_ID, Dep, Date_week, ins_ves_yn) |>
# get total number of hours for Y and N groups per each hour per deployment
summarize(n_hours = n())|>
mutate(freq = n_hours/sum(n_hours)) |>
ungroup() |>
complete(Site_ID, ins_ves_yn,
fill = list(ins_ves_yn = "Y", freq = 0)) |>
group_by(Site_ID, ins_ves_yn) |>
# reshape for easier plotting
pivot_longer(cols = c("freq"),
values_to = "Perc_per_hour") |>
# add network for grouping/faceting later
mutate(
network = case_when(Site_ID == "CG" | Site_ID == "EP" | Site_ID == "WP" ~ "Temperate East",
Site_ID == "DNE" | Site_ID == "DSW" | Site_ID == "NGN"| Site_ID == "NGS" ~ "Northwest",
TRUE ~ "South-west"
),
network = factor(network, levels = c("Temperate East","Northwest","South-west")),
npz_id = case_when(
# Cod Grounds
Site_ID == "CG" ~ "CGMP",
# Solitary Islands
Site_ID == "EP" | Site_ID == "WP" ~ "SIMP",
# Dampier
Site_ID == "DNE" | Site_ID == "DSW" ~ "DMP",
# Ningaloo
Site_ID == "NGN"| Site_ID == "NGS" ~ "NMP",
# Two Rocks
Site_ID == "TRE" | Site_ID == "TRW" ~ "TRMP",
# Jurien
Site_ID == "JSE" | Site_ID == "JNE" ~ "JMP",
# Geographe
Site_ID == "GEO" ~ "GMP",
# Murat
Site_ID == "MRE" | Site_ID == "MRW" ~ "MMP",
# South-west Corner
Site_ID == "SWS" ~ "SWCMP"
)
)
View(ins_ves_prop_hrs)
View(all_sites_hp)
# Plot inside (sm-med) vessels by deployment
ggplot(data = ins_ves_prop_hrs |>
filter(ins_ves_yn == "Y"),
aes(x = npz_id,
y = Perc_per_hour,
fill = network,
color = network))+
geom_boxplot(aes(group = Dep),
position = position_dodge2(preserve = "single"),
alpha = 0.5,
width = 0.5)+
# geom_point(aes(group = Dep),
#            alpha = 0.5,
#            position = position_jitterdodge(dodge.width = 0.25,
#                                            jitter.width = 0)) +
scale_fill_viridis_d(end = 0.75,
direction = -1,
guide = "none")+
scale_color_viridis_d(end = 0.75,
direction = -1,
guide = "none")+
facet_grid(~network,
scales = "free_x",
space = "free",
drop = TRUE) +
labs(x = "NPZ",
y = "Proportion hours per week with \nvessels inside park") +
theme(
strip.text.x = element_text(face = "bold"),
axis.text.x = element_text(face = "bold")
)
ggsave(paste0("Figures/", "Prop_hrs_ins_boxplot_by_dep.png"), width=10, height=6,
units="in", dpi=300)
# Vessels inside parks -- N hours with vessel inside park out of N deployment hours
ins_sm_ves_prop_hrs <- all_sites_hp |>
# group by y/n column to collapse into hours
group_by(network, npz_id, Site_ID, Dep, Date_week, ins_ves_small_yn) |>
# get total number of hours for Y and N groups per each hour per deployment
summarize(n_hours = n())|>
mutate(freq = n_hours/sum(n_hours)) |>
ungroup() |>
complete(Site_ID, ins_ves_small_yn,
fill = list(ins_ves_small_yn = "Y", freq = 0)) |>
group_by(Site_ID, ins_ves_small_yn) |>
# reshape for easier plotting
pivot_longer(cols = c("freq"),
values_to = "Perc_per_hour") |>
# add network for grouping/faceting later
mutate(
network = case_when(Site_ID == "CG" | Site_ID == "EP" | Site_ID == "WP" ~ "Temperate East",
Site_ID == "DNE" | Site_ID == "DSW" | Site_ID == "NGN"| Site_ID == "NGS" ~ "Northwest",
TRUE ~ "South-west"
),
network = factor(network, levels = c("Temperate East","Northwest","South-west")),
npz_id = case_when(
# Cod Grounds
Site_ID == "CG" ~ "CGMP",
# Solitary Islands
Site_ID == "EP" | Site_ID == "WP" ~ "SIMP",
# Dampier
Site_ID == "DNE" | Site_ID == "DSW" ~ "DMP",
# Ningaloo
Site_ID == "NGN"| Site_ID == "NGS" ~ "NMP",
# Two Rocks
Site_ID == "TRE" | Site_ID == "TRW" ~ "TRMP",
# Jurien
Site_ID == "JSE" | Site_ID == "JNE" ~ "JMP",
# Geographe
Site_ID == "GEO" ~ "GMP",
# Murat
Site_ID == "MRE" | Site_ID == "MRW" ~ "MMP",
# South-west Corner
Site_ID == "SWS" ~ "SWCMP"
)
)
# Try to plot!
ggplot(data = ins_sm_ves_prop_hrs |> filter(ins_ves_small_yn == "Y"),
aes(x = npz_id,
y = Perc_per_hour,
fill = network,
color = network))+
geom_boxplot(aes(group = Dep),
position = position_dodge2(preserve = "single"),
alpha = 0.5,
width = 0.5)+
scale_fill_viridis_d(end = 0.75,
direction = -1,
guide = "none")+
scale_color_viridis_d(end = 0.75,
direction = -1,
guide = "none")+
facet_grid(~network,
scales = "free_x",
space = "free",
drop = TRUE) +
labs(x = "NPZ",
y = "Proportion hours per week \nwith vessels inside NPZ (small)") +
theme(
strip.text.x = element_text(face = "bold"),
axis.text.x = element_text(face = "bold")
)
ggsave(paste0("Figures/", "Prop_hrs_ins_small_boxplot_by_dep.png"), width=10, height=6,
units="in", dpi=300)
all_perc_weekday <- all_sites_hp |>
# group by date
group_by(network, npz_id, Site_ID, Dep, Date_noyr, Begin_Date_loc, Weekday, ves_yn) |>
# get total number of hours for Y and N groups per each hour per deployment
summarize(n_hours = n())|>
mutate(freq = n_hours/sum(n_hours))
View(all_perc_weekday)
# Weekday proportional presence
# of all available hours represented by X weekday, Y% had vessels present
all_perc_weekday <- all_sites_hp |>
# group by date
group_by(network, npz_id, Site_ID, Dep, Date_noyr, Begin_Date_loc, Weekday, ves_yn) |>
# get total number of hours for Y and N groups per each hour per deployment
summarize(n_hours = n())|>
mutate(freq = n_hours/sum(n_hours)) |>
ungroup() |>
complete(Dep, Weekday, ves_yn,
fill = list(ves_yn = "Y", freq = 0)) |>
group_by(network, npz_id, Site_ID, Dep, Weekday, ves_yn) |>
# reshape for easier plotting
pivot_longer(cols = c("freq"),
values_to = "Perc_per_hour") |>
mutate(Weekday = factor(Weekday, levels=c("Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday")),
network = case_when(Site_ID == "CG" | Site_ID == "EP" | Site_ID == "WP" ~ "Temperate East",
Site_ID == "DNE" | Site_ID == "DSW" | Site_ID == "NGN"| Site_ID == "NGS" ~ "Northwest",
TRUE ~ "South-west"
),
network = factor(network, levels = c("Temperate East","Northwest","South-west")))
levels(all_perc_weekday$Weekday) <- c("M","T","W","R","F","Sa","Su")
ggplot(data = all_perc_weekday |> filter(ves_yn == "Y"),
aes(x = Weekday,
y = Perc_per_hour,
fill = network,
color = network))+
geom_boxplot(
position = position_dodge2(preserve = "single"),
alpha = 0.5,
width = 0.5,
outliers = FALSE)+
geom_point(alpha = 0.5,
position = position_jitterdodge(jitter.width = 0.1)) +
scale_fill_viridis_d(end = 0.75,
direction = -1
)+
scale_color_viridis_d(end = 0.75,
direction = -1,
guide = "none")+
# facet_grid(rows = vars(network),
#            drop = TRUE) +
labs(x = "Weekday",
y = "Proportion hours per weekday",
fill = "Network") +
theme(
strip.text.y = element_text(face = "bold"),
axis.text.y = element_text(face = "bold"),
axis.text.x = element_text(face = "bold")
)
# count up total vessels and vessels inside parks by weekday
all_ves_by_weekday <- all_sites_hp |>
group_by(network, npz_id, Site_ID, Dep, Date_noyr, Weekday) |>
summarise(n_days = n_distinct(Date_noyr),
Total_ves_dep = sum(Total_Vessels, na.rm = TRUE),
Total_ves_per_day = Total_ves_dep/n_days,
Total_inside_ves_dep = sum(total_inside, na.rm = TRUE),
Total_inside_ves_per_day = Total_inside_ves_dep/n_days) |>
mutate(Weekday = factor(Weekday, levels=c("Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday")),
network = case_when(Site_ID == "CG" | Site_ID == "EP" | Site_ID == "WP" ~ "Temperate East",
Site_ID == "DNE" | Site_ID == "DSW" | Site_ID == "NGN"| Site_ID == "NGS" ~ "Northwest",
TRUE ~ "South-west"
),
network = factor(network, levels = c("Temperate East","Northwest","South-west")))
levels(all_ves_by_weekday$Weekday) <- c("M","T","W","R","F","Sa","Su")
weekday_summary <- all_ves_by_weekday |>
group_by(network, npz_id, Site_ID, Dep, Date_noyr, Weekday) |>
summarise(total_weekday = sum(Total_ves_dep),
median_ves_weekday = median(Total_ves_dep),
weekday_lower = quantile(Total_ves_dep, 0.25),
weekday_upper = quantile(Total_ves_dep, 0.75),
total_ins_weekday = sum(Total_inside_ves_dep),
median_ins_ves_weekday = median(Total_inside_ves_dep),
weekday_ins_lower = quantile(Total_inside_ves_dep, 0.25),
weekday_ins_upper = quantile(Total_inside_ves_dep, 0.75)) |>
mutate(Weekday = factor(Weekday, levels=c("M","T","W","R","F","Sa","Su")),
network = case_when(Site_ID == "CG" | Site_ID == "EP" | Site_ID == "WP" ~ "Temperate East",
Site_ID == "DNE" | Site_ID == "DSW" | Site_ID == "NGN"| Site_ID == "NGS" ~ "Northwest",
TRUE ~ "South-west"
),
network = factor(network, levels = c("Temperate East","Northwest","South-west")))
# Weekday proportional presence
# of all available hours represented by X weekday, Y% had vessels present
all_perc_weekday <- all_sites_hp |>
# group by date
group_by(network, npz_id, Site_ID, Dep, Date_noyr, Begin_Date_loc, Weekday, ves_yn) |>
# get total number of hours for Y and N groups per each hour per deployment
summarize(n_hours = n())|>
mutate(freq = n_hours/sum(n_hours)) |>
ungroup() |>
complete(Dep, Weekday, ves_yn,
fill = list(ves_yn = "Y", freq = 0)) |>
group_by(network, npz_id, Site_ID, Dep, Weekday, ves_yn) |>
# reshape for easier plotting
pivot_longer(cols = c("freq"),
values_to = "Perc_per_hour") |>
mutate(Weekday = factor(Weekday, levels=c("Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday")),
network = case_when(Site_ID == "CG" | Site_ID == "EP" | Site_ID == "WP" ~ "Temperate East",
Site_ID == "DNE" | Site_ID == "DSW" | Site_ID == "NGN"| Site_ID == "NGS" ~ "Northwest",
TRUE ~ "South-west"
),
network = factor(network, levels = c("Temperate East","Northwest","South-west")))
levels(all_perc_weekday$Weekday) <- c("M","T","W","R","F","Sa","Su")
ggplot(data = all_perc_weekday |> filter(ves_yn == "Y"),
aes(x = Weekday,
y = Perc_per_hour,
fill = network,
color = network))+
geom_boxplot(
position = position_dodge2(preserve = "single"),
alpha = 0.5,
width = 0.5,
outliers = FALSE)+
geom_point(alpha = 0.5,
position = position_jitterdodge(jitter.width = 0.1)) +
scale_fill_viridis_d(end = 0.75,
direction = -1
)+
scale_color_viridis_d(end = 0.75,
direction = -1,
guide = "none")+
# facet_grid(rows = vars(network),
#            drop = TRUE) +
labs(x = "Weekday",
y = "Proportion hours per weekday",
fill = "Network") +
theme(
strip.text.y = element_text(face = "bold"),
axis.text.y = element_text(face = "bold"),
axis.text.x = element_text(face = "bold")
)
# start with full hp dataset
all_perc_weekday <- all_sites_hp |>
# group by date to get % presence per day
group_by(network, npz_id, Site_ID, Dep, Date_noyr, Begin_Date_loc, Weekday, ves_yn) |>
# get total number of hours for Y and N groups per each hour per deployment
summarize(n_hours = n())|>
mutate(freq = n_hours/sum(n_hours)) |>
# ungroup to fill in any missing values for columns
ungroup() |>
complete(Dep, Weekday, ves_yn,
fill = list(ves_yn = "Y", freq = 0)) |>
# regroup
group_by(network, npz_id, Site_ID, Dep, Begin_Date_loc, Weekday, ves_yn) |>
# reshape for easier plotting
pivot_longer(cols = c("freq"),
values_to = "Perc_per_hour") |>
mutate(Weekday = factor(Weekday, levels=c("Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday")),
network = case_when(Site_ID == "CG" | Site_ID == "EP" | Site_ID == "WP" ~ "Temperate East",
Site_ID == "DNE" | Site_ID == "DSW" | Site_ID == "NGN"| Site_ID == "NGS" ~ "Northwest",
TRUE ~ "South-west"
),
network = factor(network, levels = c("Temperate East","Northwest","South-west")))
levels(all_perc_weekday$Weekday) <- c("M","T","W","R","F","Sa","Su")
ggplot(data = all_perc_weekday |>
filter(ves_yn == "Y"),
aes(x = Weekday,
y = Perc_per_hour,
fill = network,
color = network))+
geom_boxplot(
position = position_dodge2(preserve = "single"),
alpha = 0.5,
width = 0.5,
outliers = FALSE)+
geom_point(alpha = 0.5,
position = position_jitterdodge(jitter.width = 0.1)) +
scale_fill_viridis_d(end = 0.75,
direction = -1
)+
scale_color_viridis_d(end = 0.75,
direction = -1,
guide = "none")+
# facet_grid(rows = vars(network),
#            drop = TRUE) +
labs(x = "Weekday",
y = "Proportion hours per weekday",
fill = "Network") +
theme(
strip.text.y = element_text(face = "bold"),
axis.text.y = element_text(face = "bold"),
axis.text.x = element_text(face = "bold")
)
ggplot(data = all_perc_weekday |>
filter(ves_yn == "Y"),
aes(x = Weekday,
y = Perc_per_hour,
fill = network,
color = network))+
geom_boxplot(
position = position_dodge2(preserve = "single"),
alpha = 0.5,
width = 0.5)+
# geom_point(alpha = 0.5,
#            position = position_jitterdodge(jitter.width = 0.1)) +
scale_fill_viridis_d(end = 0.75,
direction = -1
)+
scale_color_viridis_d(end = 0.75,
direction = -1,
guide = "none")+
# facet_grid(rows = vars(network),
#            drop = TRUE) +
labs(x = "Weekday",
y = "Proportion hours per weekday",
fill = "Network") +
theme(
strip.text.y = element_text(face = "bold"),
axis.text.y = element_text(face = "bold"),
axis.text.x = element_text(face = "bold")
)
ggplot(data = all_perc_weekday |>
filter(ves_yn == "Y"),
aes(x = Weekday,
y = Perc_per_hour,
fill = network,
color = network))+
geom_boxplot(aes(group = Dep),
position = position_dodge2(preserve = "single"),
alpha = 0.5,
width = 0.5)+
# geom_point(alpha = 0.5,
#            position = position_jitterdodge(jitter.width = 0.1)) +
scale_fill_viridis_d(end = 0.75,
direction = -1
)+
scale_color_viridis_d(end = 0.75,
direction = -1,
guide = "none")+
facet_grid(rows = vars(network),
drop = TRUE) +
labs(x = "Weekday",
y = "Proportion hours per weekday",
fill = "Network") +
theme(
strip.text.y = element_text(face = "bold"),
axis.text.y = element_text(face = "bold"),
axis.text.x = element_text(face = "bold")
)
ggplot(data = all_perc_weekday |>
filter(ves_yn == "Y"),
aes(x = Weekday,
y = Perc_per_hour,
fill = network,
color = network))+
geom_boxplot(aes(group = Dep),
position = position_dodge2(preserve = "single"),
alpha = 0.5,
width = 0.5)
ggplot(data = all_perc_weekday |>
filter(ves_yn == "Y"),
aes(x = Weekday,
y = Perc_per_hour,
fill = network,
color = network))+
geom_boxplot(
position = position_dodge2(preserve = "single"),
alpha = 0.5,
width = 0.5)+
# geom_point(alpha = 0.5,
#            position = position_jitterdodge(jitter.width = 0.1)) +
scale_fill_viridis_d(end = 0.75,
direction = -1
)+
scale_color_viridis_d(end = 0.75,
direction = -1,
guide = "none")+
facet_grid(rows = vars(Dep),
drop = TRUE) +
labs(x = "Weekday",
y = "Proportion hours per weekday",
fill = "Network") +
theme(
strip.text.y = element_text(face = "bold"),
axis.text.y = element_text(face = "bold"),
axis.text.x = element_text(face = "bold")
)
ggplot(data = all_perc_weekday |>
filter(ves_yn == "Y"),
aes(x = Weekday,
y = Perc_per_hour,
fill = network,
color = network))+
geom_boxplot(
position = position_dodge2(preserve = "single"),
alpha = 0.5,
width = 0.5)+
# geom_point(alpha = 0.5,
#            position = position_jitterdodge(jitter.width = 0.1)) +
scale_fill_viridis_d(end = 0.75,
direction = -1
)+
scale_color_viridis_d(end = 0.75,
direction = -1,
guide = "none")+
facet_grid(rows = vars(network),
drop = TRUE) +
labs(x = "Weekday",
y = "Proportion hours per weekday",
fill = "Network") +
theme(
strip.text.y = element_text(face = "bold"),
axis.text.y = element_text(face = "bold"),
axis.text.x = element_text(face = "bold")
)
ggsave(paste0("Figures/", "Weekday_prop_hrs_facets.png"), width=10, height=6,
units="in", dpi=300)
