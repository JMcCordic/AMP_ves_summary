strip.text.y = element_text(face = "bold"),
axis.text.y = element_text(face = "bold"),
axis.text.x = element_text(face = "bold")
)
ggplot(data = all_perc_weekday |>
filter(ves_yn == "Y",
!is.na(npz_id)),
aes(x = Weekday,
y = Perc_per_hour,
fill = network,
color = network))+
geom_boxplot(
position = position_dodge2(preserve = "single"),
alpha = 0.5,
width = 0.5)+
# geom_point(alpha = 0.5,
#            position = position_jitterdodge(jitter.width = 0.1)) +
scale_fill_viridis_d(end = 0.75,
direction = -1
)+
scale_color_viridis_d(end = 0.75,
direction = -1,
guide = "none")+
facet_wrap(network ~ npz_id,
drop = TRUE) +
labs(x = "Weekday",
y = "Proportion hours per weekday",
fill = "Network") +
theme(
strip.text.y = element_text(face = "bold"),
axis.text.y = element_text(face = "bold"),
axis.text.x = element_text(face = "bold")
)
# start with full hp dataset
all_perc_weekday <- all_sites_hp |>
# group by date to get % presence per day
group_by(network, npz_id, Site_ID, Dep, Date_noyr, Begin_Date_loc, Weekday, ves_yn) |>
# get total number of hours for Y and N groups per each hour per deployment
summarize(n_hours = n())|>
mutate(freq = n_hours/sum(n_hours)) |>
# ungroup to fill in any missing values for columns
ungroup() |>
complete(Dep, Weekday, ves_yn,
fill = list(ves_yn = "Y", freq = 0)) |>
# regroup
group_by(network, npz_id, Site_ID, Dep, Begin_Date_loc, Weekday, ves_yn) |>
# reshape for easier plotting
pivot_longer(cols = c("freq"),
values_to = "Perc_per_hour") |>
mutate(Weekday = factor(Weekday, levels=c("Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday")),
network = case_when(Site_ID == "CG" | Site_ID == "EP" | Site_ID == "WP" ~ "Temperate East",
Site_ID == "DNE" | Site_ID == "DSW" | Site_ID == "NGN"| Site_ID == "NGS" ~ "Northwest",
TRUE ~ "South-west"
),
network = factor(network, levels = c("Temperate East","Northwest","South-west")))
levels(all_perc_weekday$Weekday) <- c("M","T","W","R","F","Sa","Su")
ggplot(data = all_perc_weekday |>
filter(ves_yn == "Y",
!is.na(npz_id)),
aes(x = Weekday,
y = Perc_per_hour,
fill = network,
color = network))+
geom_boxplot(
position = position_dodge2(preserve = "single"),
alpha = 0.5,
width = 0.5)+
# geom_point(alpha = 0.5,
#            position = position_jitterdodge(jitter.width = 0.1)) +
scale_fill_viridis_d(end = 0.75,
direction = -1
)+
scale_color_viridis_d(end = 0.75,
direction = -1,
guide = "none")+
facet_wrap(network ~ npz_id,
drop = TRUE) +
labs(x = "Weekday",
y = "Proportion hours per weekday",
fill = "Network") +
theme(
strip.text.y = element_text(face = "bold"),
axis.text.y = element_text(face = "bold"),
axis.text.x = element_text(face = "bold")
)
ggplot(data = all_perc_weekday |>
filter(ves_yn == "Y",
!is.na(npz_id)),
aes(x = Weekday,
y = Perc_per_hour,
fill = Dep,
color = Dep))+
geom_boxplot(
position = position_dodge2(preserve = "single"),
alpha = 0.5,
width = 0.5)+
# geom_point(alpha = 0.5,
#            position = position_jitterdodge(jitter.width = 0.1)) +
scale_fill_viridis_d(end = 0.75,
direction = -1
)+
scale_color_viridis_d(end = 0.75,
direction = -1,
guide = "none")+
facet_wrap(network ~ npz_id,
drop = TRUE) +
labs(x = "Weekday",
y = "Proportion hours per weekday",
fill = "Network") +
theme(
strip.text.y = element_text(face = "bold"),
axis.text.y = element_text(face = "bold"),
axis.text.x = element_text(face = "bold")
)
ggplot(data = all_perc_weekday |>
filter(ves_yn == "Y",
!is.na(npz_id)),
aes(x = Weekday,
y = Perc_per_hour,
fill = Dep,
color = Dep))+
geom_boxplot(
position = position_dodge2(preserve = "single"),
alpha = 0.5,
width = 0.5,
show.legend = FALSE)+
# geom_point(alpha = 0.5,
#            position = position_jitterdodge(jitter.width = 0.1)) +
scale_fill_viridis_d(end = 0.75,
direction = -1
)+
scale_color_viridis_d(end = 0.75,
direction = -1,
guide = "none")+
facet_wrap(network ~ npz_id,
drop = TRUE) +
labs(x = "Weekday",
y = "Proportion hours per weekday") +
theme(
strip.text.y = element_text(face = "bold"),
axis.text.y = element_text(face = "bold"),
axis.text.x = element_text(face = "bold")
)
ggsave(paste0("figs/", "Weekday_prop_hrs_dep_ntwk.png"), width=10, height=6,
units="in", dpi=300)
ggplot(data = all_perc_weekday |> filter(ves_yn == "Y",
network == "South-west"),
aes(x = Weekday,
y = Perc_per_hour,
fill = npz_id,
color = npz_id))+
geom_boxplot(
position = position_dodge2(preserve = "single"),
alpha = 0.5,
width = 0.5,
outliers = FALSE)+
geom_point(alpha = 0.5,
position = position_jitterdodge(jitter.width = 0.1)) +
scale_fill_viridis_d(end = 0.75,
direction = -1
)+
scale_color_viridis_d(end = 0.75,
direction = -1,
guide = "none")+
# facet_grid(rows = vars(network),
#            drop = TRUE) +
labs(x = "Weekday",
y = "Proportion hours per weekday",
fill = "NPZ") +
theme(
strip.text.y = element_text(face = "bold"),
axis.text.y = element_text(face = "bold"),
axis.text.x = element_text(face = "bold")
)
ggplot(data = all_perc_weekday |>
filter(ves_yn == "Y",
!is.na(npz_id),
network == "South-west"),
aes(x = Weekday,
y = Perc_per_hour,
fill = npz_id,
color = npz_id))+
geom_boxplot(
position = position_dodge2(preserve = "single"),
alpha = 0.5,
width = 0.5)+
scale_fill_viridis_d(end = 0.75,
direction = -1
)+
scale_color_viridis_d(end = 0.75,
direction = -1,
guide = "none")+
# facet_grid(rows = vars(network),
#            drop = TRUE) +
labs(x = "Weekday",
y = "Proportion hours per weekday",
fill = "NPZ") +
theme(
strip.text.y = element_text(face = "bold"),
axis.text.y = element_text(face = "bold"),
axis.text.x = element_text(face = "bold")
)
ggplot(data = all_perc_weekday |>
filter(ves_yn == "Y",
!is.na(npz_id),
network == "South-west"),
aes(x = Weekday,
y = Perc_per_hour,
fill = npz_id,
color = npz_id))+
geom_boxplot(
position = position_dodge2(preserve = "single"),
# alpha = 0.5,
width = 0.5)+
scale_fill_viridis_d(end = 0.75,
direction = -1
)+
scale_color_viridis_d(end = 0.75,
direction = -1,
guide = "none")+
# facet_grid(rows = vars(network),
#            drop = TRUE) +
labs(x = "Weekday",
y = "Proportion hours per weekday",
fill = "NPZ") +
theme(
strip.text.y = element_text(face = "bold"),
axis.text.y = element_text(face = "bold"),
axis.text.x = element_text(face = "bold")
)
ggplot(data = all_perc_weekday |>
filter(ves_yn == "Y",
!is.na(npz_id),
network == "South-west"),
aes(x = Weekday,
y = Perc_per_hour,
fill = npz_id,
color = npz_id))+
geom_boxplot(
position = position_dodge2(preserve = "single"),
alpha = 07.5,
width = 0.5)+
scale_fill_viridis_d(end = 0.75,
direction = -1
)+
scale_color_viridis_d(end = 0.75,
direction = -1,
guide = "none")+
# facet_grid(rows = vars(network),
#            drop = TRUE) +
labs(x = "Weekday",
y = "Proportion hours per weekday",
fill = "NPZ") +
theme(
strip.text.y = element_text(face = "bold"),
axis.text.y = element_text(face = "bold"),
axis.text.x = element_text(face = "bold")
)
ggplot(data = all_perc_weekday |>
filter(ves_yn == "Y",
!is.na(npz_id),
network == "South-west"),
aes(x = Weekday,
y = Perc_per_hour,
fill = npz_id,
color = npz_id))+
geom_boxplot(
position = position_dodge2(preserve = "single"),
alpha = 0.75,
width = 0.5)+
scale_fill_viridis_d(end = 0.75,
direction = -1
)+
scale_color_viridis_d(end = 0.75,
direction = -1,
guide = "none")+
# facet_grid(rows = vars(network),
#            drop = TRUE) +
labs(x = "Weekday",
y = "Proportion hours per weekday",
fill = "NPZ") +
theme(
strip.text.y = element_text(face = "bold"),
axis.text.y = element_text(face = "bold"),
axis.text.x = element_text(face = "bold")
)
ggplot(data = all_perc_weekday |>
filter(ves_yn == "Y",
network == "South-west"),
aes(x = Weekday,
y = Perc_per_hour,
fill = npz_id,
color = npz_id))+
geom_boxplot(
position = position_dodge2(preserve = "single"),
alpha = 0.75,
width = 0.5)+
scale_fill_viridis_d(end = 0.75,
direction = -1
)+
scale_color_viridis_d(end = 0.75,
direction = -1,
guide = "none")+
# facet_grid(rows = vars(network),
#            drop = TRUE) +
labs(x = "Weekday",
y = "Proportion hours per weekday",
fill = "NPZ") +
theme(
strip.text.y = element_text(face = "bold"),
axis.text.y = element_text(face = "bold"),
axis.text.x = element_text(face = "bold")
)
ggplot(data = all_perc_weekday |>
filter(ves_yn == "Y",
!is.na(npz_id),
network == "South-west"),
aes(x = Weekday,
y = Perc_per_hour,
fill = npz_id,
color = npz_id))+
geom_boxplot(
position = position_dodge2(preserve = "single"),
alpha = 0.75,
width = 0.5)+
scale_fill_viridis_d(end = 0.75,
direction = -1
)+
scale_color_viridis_d(end = 0.75,
direction = -1,
guide = "none")+
# facet_grid(rows = vars(network),
#            drop = TRUE) +
labs(x = "Weekday",
y = "Proportion hours per weekday",
fill = "NPZ") +
theme(
strip.text.y = element_text(face = "bold"),
axis.text.y = element_text(face = "bold"),
axis.text.x = element_text(face = "bold")
)
ggplot(data = all_perc_weekday |>
filter(ves_yn == "Y",
!is.na(npz_id),
network == "South-west"),
aes(x = Weekday,
y = Perc_per_hour,
fill = npz_id,
color = npz_id))+
geom_boxplot(
position = position_dodge2(preserve = "single"),
alpha = 0.75,
width = 0.5)+
scale_fill_viridis_d(end = 0.75,
direction = -1
)+
scale_color_viridis_d(end = 0.75,
direction = -1,
guide = "none")+
facet_grid(rows = vars(npz_id),
drop = TRUE) +
labs(x = "Weekday",
y = "Proportion hours per weekday",
fill = "NPZ") +
theme(
strip.text.y = element_text(face = "bold"),
axis.text.y = element_text(face = "bold"),
axis.text.x = element_text(face = "bold")
)
ggsave(paste0("figs/", "Weekday_prop_hrs_npz_southwest.png"), width=6, height=10,
units="in", dpi=300)
ggplot(data = all_perc_weekday |>
filter(ves_yn == "Y",
!is.na(npz_id),
network == "Temperate East"),
aes(x = Weekday,
y = Perc_per_hour,
fill = npz_id,
color = npz_id))+
geom_boxplot(
position = position_dodge2(preserve = "single"),
alpha = 0.75,
width = 0.5)+
scale_fill_viridis_d(end = 0.75,
direction = -1
)+
scale_color_viridis_d(end = 0.75,
direction = -1,
guide = "none")+
facet_grid(rows = vars(npz_id),
drop = TRUE) +
labs(x = "Weekday",
y = "Proportion hours per weekday",
fill = "NPZ") +
theme(
strip.text.y = element_text(face = "bold"),
axis.text.y = element_text(face = "bold"),
axis.text.x = element_text(face = "bold")
)
ggplot(data = all_perc_weekday |>
filter(ves_yn == "Y",
!is.na(npz_id),
network == "Temperate East"),
aes(x = Weekday,
y = Perc_per_hour,
fill = Dep,
color = Dep))+
geom_boxplot(
position = position_dodge2(preserve = "single"),
alpha = 0.75,
width = 0.5)+
scale_fill_viridis_d(end = 0.75,
direction = -1
)+
scale_color_viridis_d(end = 0.75,
direction = -1,
guide = "none")+
facet_grid(rows = vars(npz_id),
drop = TRUE) +
labs(x = "Weekday",
y = "Proportion hours per weekday",
fill = "NPZ") +
theme(
strip.text.y = element_text(face = "bold"),
axis.text.y = element_text(face = "bold"),
axis.text.x = element_text(face = "bold")
)
ggplot(data = all_perc_weekday |>
filter(ves_yn == "Y",
!is.na(npz_id),
network == "Temperate East"),
aes(x = Weekday,
y = Perc_per_hour,
fill = Dep,
color = Dep))+
geom_boxplot(
position = position_dodge2(preserve = "single"),
alpha = 0.75,
width = 0.5)+
scale_fill_viridis_d(end = 0.75,
direction = -1
)+
scale_color_viridis_d(end = 0.75,
direction = -1,
guide = "none")+
facet_grid(rows = vars(Dep),
drop = TRUE) +
labs(x = "Weekday",
y = "Proportion hours per weekday",
fill = "NPZ") +
theme(
strip.text.y = element_text(face = "bold"),
axis.text.y = element_text(face = "bold"),
axis.text.x = element_text(face = "bold")
)
ggplot(data = all_perc_weekday |>
filter(ves_yn == "Y",
!is.na(npz_id),
network == "Temperate East"),
aes(x = Weekday,
y = Perc_per_hour,
fill = Dep,
color = Dep))+
geom_boxplot(
position = position_dodge2(preserve = "single"),
alpha = 0.75,
width = 0.5)+
scale_fill_viridis_d(end = 0.75,
direction = -1
)+
scale_color_viridis_d(end = 0.75,
direction = -1,
guide = "none")+
facet_grid(rows = vars(npz_id),
drop = TRUE) +
labs(x = "Weekday",
y = "Proportion hours per weekday",
fill = "NPZ") +
theme(
strip.text.y = element_text(face = "bold"),
axis.text.y = element_text(face = "bold"),
axis.text.x = element_text(face = "bold")
)
ggplot(data = all_perc_weekday |>
filter(ves_yn == "Y",
!is.na(npz_id)),
aes(x = Weekday,
y = Perc_per_hour,
fill = Dep,
color = Dep))+
geom_boxplot(
position = position_dodge2(preserve = "single"),
alpha = 0.5,
width = 0.5,
show.legend = FALSE)+
# geom_point(alpha = 0.5,
#            position = position_jitterdodge(jitter.width = 0.1)) +
scale_fill_viridis_d(end = 0.75,
direction = -1
)+
scale_color_viridis_d(end = 0.75,
direction = -1,
guide = "none")+
facet_wrap(network ~ npz_id,
drop = TRUE) +
labs(x = "Weekday",
y = "Proportion hours per weekday") +
theme(
strip.text.y = element_text(face = "bold"),
axis.text.y = element_text(face = "bold"),
axis.text.x = element_text(face = "bold")
)
