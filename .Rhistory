title = "") +
facet_nested(rows = vars(network, npz_id, Dep_ID),
nest_line = element_line(),
scales = "free_y",
switch = "y") +
theme(
axis.text.x = element_text(face = "bold"),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
strip.background = element_blank(),
strip.text.y = element_text(face = "bold")
)
ggsave(paste0("figs/", "Ins_out_counts_npz.png"), width=10, height=8,
units="in", dpi=300)
# Small vessels inside-outside
breakvals_small <- seq(-600, 600, 200)
ggplot(data = all_ves_long |>
filter(Ves_behav == "total_out_small" |
Ves_behav == "Total_inside_small",
npz_id != "SWCMP"),
aes(x = npz_id,
y = ves_counts_diverge,
fill = Ves_behav)) +
geom_col(position = position_stack(reverse = TRUE)) +
coord_flip()+
scale_y_continuous(limits = c(-600, 600),
breaks = breakvals_small,
labels = abs(breakvals_small))+
scale_fill_viridis_d(direction = -1)+
labs(y = "N vessels",
fill = "Inside vs. Outside",
title = "Inside-Outside Counts (Small Vessels)") +
facet_nested(rows = vars(network, npz_id, Dep_ID),
nest_line = element_line(),
scales = "free_y",
switch = "y") +
theme(
axis.text.x = element_text(face = "bold"),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
strip.background = element_blank(),
strip.text.y = element_text(face = "bold")
)
ggsave(paste0("figs/", "Ins_out_counts_small_npz.png"), width=10, height=8,
units="in", dpi=300)
# make table of inside vs. outside
ins_out_table <- all_ves_long |>
filter(Ves_behav == "total_outside" |
Ves_behav == "Total_inside"|
Ves_behav == "total_out_small" |
Ves_behav == "Total_inside_small",
npz_id != "SWCMP") |>
pivot_wider(names_from = Ves_behav,
id_cols = Dep,
values_from = Ves_counts) |>
relocate(total_outside, .after = Total_inside) |>
rename("Total inside" = "Total_inside",
"Total inside (small)" = "Total_inside_small",
"Total outside" = "total_outside",
"Total outside (small)" = "total_out_small",
"Deployment" = "Dep")
knitr::kable(ins_out_table, caption = "Vessel counts inside and outside NPZ boundaries")
breakvals <- seq(-200, 800, 200)
ggplot(data = all_ves_long |>
filter(Ves_behav == "total_outside" |
Ves_behav == "Total_inside",
npz_id != "SWCMP"),
aes(x = npz_id,
y = ves_counts_diverge,
fill = network,
alpha = Ves_behav)) +
geom_col(position = position_stack(reverse = TRUE)) +
guides(fill = "none")+ # take away fill legend but keep alpha legend
coord_flip()+
scale_y_continuous(limits = c(-200, 800),
breaks = breakvals,
labels = abs(breakvals))+
scale_fill_manual(values = c("Temperate East" = "#00AB8E",
"Northwest" = "#A05EB5",
"South-west" = "#485CC7"))+
scale_alpha_manual(values = c(0.9,0.4),
labels = c(">0.75" , "\u2264 0.75"))+
labs(y = "N vessels",
alpha = "Probability of vessel\nwithin NPZ",
title = "",
fill = NULL) +
facet_nested(rows = vars(network, npz_id, Dep_ID),
nest_line = element_line(),
scales = "free_y",
switch = "y") +
theme(
axis.text.x = element_text(face = "bold"),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
strip.background = element_blank(),
strip.text.y = element_text(face = "bold")
)
ggsave(paste0("figs/", "Ins_out_counts_npz_colors.png"), width=10, height=8,
units="in", dpi=300)
?ggpattern
ggplot(data = all_ves_long |>
filter(Ves_behav == "total_outside" |
Ves_behav == "Total_inside",
npz_id != "SWCMP"),
aes(x = npz_id,
y = ves_counts_diverge,
fill = network,
alpha = Ves_behav)) +
geom_col_pattern(aes(pattern = 'stripe'),
position = position_stack(reverse = TRUE)) +
guides(fill = "none")+ # take away fill legend but keep alpha legend
coord_flip()+
scale_y_continuous(limits = c(-200, 800),
breaks = breakvals,
labels = abs(breakvals))+
scale_fill_manual(values = c("Temperate East" = "#00AB8E",
"Northwest" = "#A05EB5",
"South-west" = "#485CC7"))+
scale_alpha_manual(values = c(0.9,0.4),
labels = c(">0.75" , "\u2264 0.75"))+
labs(y = "N vessels",
alpha = "Probability of vessel\nwithin NPZ",
title = "",
fill = NULL) +
facet_nested(rows = vars(network, npz_id, Dep_ID),
nest_line = element_line(),
scales = "free_y",
switch = "y") +
theme(
axis.text.x = element_text(face = "bold"),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
strip.background = element_blank(),
strip.text.y = element_text(face = "bold")
)
breakvals <- seq(-200, 800, 200)
ggplot(data = all_ves_long |>
filter(Ves_behav == "total_outside" |
Ves_behav == "Total_inside",
npz_id != "SWCMP"),
aes(x = npz_id,
y = ves_counts_diverge,
fill = network,
alpha = Ves_behav)) +
geom_col_pattern(aes(pattern = 'stripe'),
position = position_stack(reverse = TRUE)) +
guides(fill = "none")+ # take away fill legend but keep alpha legend
coord_flip()+
scale_y_continuous(limits = c(-200, 800),
breaks = breakvals,
labels = abs(breakvals))+
scale_fill_manual(values = c("Temperate East" = "#00AB8E",
"Northwest" = "#A05EB5",
"South-west" = "#485CC7"))+
scale_alpha_manual(values = c(0.9,0.4),
labels = c(">0.75" , "\u2264 0.75"))+
labs(y = "N vessels",
alpha = "Probability of vessel\nwithin NPZ",
title = "",
fill = NULL) +
facet_nested(rows = vars(network, npz_id, Dep_ID),
nest_line = element_line(),
scales = "free_y",
switch = "y") +
theme(
axis.text.x = element_text(face = "bold"),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
strip.background = element_blank(),
strip.text.y = element_text(face = "bold")
)
breakvals <- seq(-200, 800, 200)
ggplot(data = all_ves_long |>
filter(Ves_behav == "total_outside" |
Ves_behav == "Total_inside",
npz_id != "SWCMP"),
aes(x = npz_id,
y = ves_counts_diverge,
fill = network,
alpha = Ves_behav)) +
geom_col_pattern(aes(pattern = "stripe"),
position = position_stack(reverse = TRUE)) +
guides(fill = "none")
ggplot(data = all_ves_long |>
filter(Ves_behav == "total_outside" |
Ves_behav == "Total_inside",
npz_id != "SWCMP"),
aes(x = npz_id,
y = ves_counts_diverge,
fill = network,
alpha = Ves_behav)) +
geom_col_pattern(aes(pattern_fill = Ves_behav),
position = position_stack(reverse = TRUE)) +
guides(fill = "none")+ # take away fill legend but keep alpha legend
coord_flip()+
scale_y_continuous(limits = c(-200, 800),
breaks = breakvals,
labels = abs(breakvals))+
scale_fill_manual(values = c("Temperate East" = "#00AB8E",
"Northwest" = "#A05EB5",
"South-west" = "#485CC7"))+
scale_alpha_manual(values = c(0.9,0.4),
labels = c(">0.75" , "\u2264 0.75"))+
labs(y = "N vessels",
alpha = "Probability of vessel\nwithin NPZ",
title = "",
fill = NULL) +
facet_nested(rows = vars(network, npz_id, Dep_ID),
nest_line = element_line(),
scales = "free_y",
switch = "y") +
theme(
axis.text.x = element_text(face = "bold"),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
strip.background = element_blank(),
strip.text.y = element_text(face = "bold")
)
ggplot(data = all_ves_long |>
filter(Ves_behav == "total_outside" |
Ves_behav == "Total_inside",
npz_id != "SWCMP"),
aes(x = npz_id,
y = ves_counts_diverge,
fill = network,
alpha = Ves_behav)) +
geom_col_pattern(aes(pattern_fill = Ves_behav),
position = position_stack(reverse = TRUE))
ggplot(data = all_ves_long |>
filter(Ves_behav == "total_outside" |
Ves_behav == "Total_inside",
npz_id != "SWCMP"),
aes(x = npz_id,
y = ves_counts_diverge,
fill = Ves_behav)) +
geom_col(position = position_stack(reverse = TRUE)) +
coord_flip()+
scale_y_continuous(limits = c(-200, 800),
breaks = breakvals,
labels = abs(breakvals))+
scale_fill_manual(values = c("black","grey75"),
labels = c(">0.75" , "\u2264 0.75"))+
labs(y = "N vessels",
fill = "Probability of vessel\nwithin NPZ",
title = "") +
facet_nested(rows = vars(network, npz_id, Dep_ID),
nest_line = element_line(),
scales = "free_y",
switch = "y") +
theme(
axis.text.x = element_text(face = "bold"),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
strip.background = element_blank(),
strip.text.y = element_text(face = "bold")
)
ggplot(data = all_ves_long |>
filter(Ves_behav == "total_outside" |
Ves_behav == "Total_inside",
npz_id != "SWCMP"),
aes(x = npz_id,
y = ves_counts_diverge,
fill = network,
alpha = Ves_behav)) +
geom_col(position = position_stack(reverse = TRUE)) +
guides(fill = "none")+ # take away fill legend but keep alpha legend
coord_flip()+
scale_y_continuous(limits = c(-200, 800),
breaks = breakvals,
labels = abs(breakvals))+
scale_fill_manual(values = c("Temperate East" = "#00AB8E",
"Northwest" = "#A05EB5",
"South-west" = "#485CC7"))+
scale_alpha_manual(values = c(0.9,0.4),
labels = c(">0.75" , "\u2264 0.75"))+
labs(y = "N vessels",
alpha = "Probability of vessel\nwithin NPZ",
title = "",
fill = NULL) +
facet_nested(rows = vars(network, npz_id, Dep_ID),
nest_line = element_line(),
scales = "free_y",
switch = "y") +
theme(
axis.text.x = element_text(face = "bold"),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
strip.background = element_blank(),
strip.text.y = element_text(face = "bold")
)
ggplot(data = all_ves_long |>
filter(Ves_behav == "total_outside" |
Ves_behav == "Total_inside",
npz_id != "SWCMP"),
aes(x = npz_id,
y = ves_counts_diverge,
fill = network,
alpha = Ves_behav)) +
geom_col_pattern(aes(pattern_fill = Ves_behav)
# position = position_stack(reverse = TRUE)
) +
guides(fill = "none")+ # take away fill legend but keep alpha legend
coord_flip()+
scale_y_continuous(limits = c(-200, 800),
breaks = breakvals,
labels = abs(breakvals))+
scale_fill_manual(values = c("Temperate East" = "#00AB8E",
"Northwest" = "#A05EB5",
"South-west" = "#485CC7"))+
scale_alpha_manual(values = c(0.9,0.4),
labels = c(">0.75" , "\u2264 0.75"))+
labs(y = "N vessels",
alpha = "Probability of vessel\nwithin NPZ",
title = "",
fill = NULL) +
facet_nested(rows = vars(network, npz_id, Dep_ID),
nest_line = element_line(),
scales = "free_y",
switch = "y") +
theme(
axis.text.x = element_text(face = "bold"),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
strip.background = element_blank(),
strip.text.y = element_text(face = "bold")
)
ggplot(data = all_ves_long |>
filter(Ves_behav == "total_outside" |
Ves_behav == "Total_inside",
npz_id != "SWCMP"),
aes(x = npz_id,
y = ves_counts_diverge,
fill = network,
alpha = Ves_behav)) +
geom_col_pattern(
# position = position_stack(reverse = TRUE)
) +
guides(fill = "none")+ # take away fill legend but keep alpha legend
coord_flip()+
scale_y_continuous(limits = c(-200, 800),
breaks = breakvals,
labels = abs(breakvals))+
scale_fill_manual(values = c("Temperate East" = "#00AB8E",
"Northwest" = "#A05EB5",
"South-west" = "#485CC7"))+
scale_alpha_manual(values = c(0.9,0.4),
labels = c(">0.75" , "\u2264 0.75"))+
labs(y = "N vessels",
alpha = "Probability of vessel\nwithin NPZ",
title = "",
fill = NULL) +
facet_nested(rows = vars(network, npz_id, Dep_ID),
nest_line = element_line(),
scales = "free_y",
switch = "y") +
theme(
axis.text.x = element_text(face = "bold"),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
strip.background = element_blank(),
strip.text.y = element_text(face = "bold")
)
ggplot(data = all_ves_long |>
filter(Ves_behav == "total_outside" |
Ves_behav == "Total_inside",
npz_id != "SWCMP"),
aes(x = npz_id,
y = ves_counts_diverge,
fill = network,
alpha = Ves_behav)) +
geom_col_pattern(
# position = position_stack(reverse = TRUE)
)
ggplot(data = all_ves_long |>
filter(Ves_behav == "total_outside" |
Ves_behav == "Total_inside",
npz_id != "SWCMP"),
aes(x = npz_id,
y = ves_counts_diverge,
fill = network,
alpha = Ves_behav)) +
geom_col(
# position = position_stack(reverse = TRUE)
)
ggplot(data = all_ves_long |>
filter(Ves_behav == "total_outside" |
Ves_behav == "Total_inside",
npz_id != "SWCMP"),
aes(x = npz_id,
y = ves_counts_diverge,
fill = network,
alpha = Ves_behav)) +
geom_col(
position = position_stack(reverse = TRUE)
)
ggplot(data = all_ves_long |>
filter(Ves_behav == "total_outside" |
Ves_behav == "Total_inside",
npz_id != "SWCMP"),
aes(x = npz_id,
y = ves_counts_diverge,
fill = network,
alpha = Ves_behav)) +
geom_col_pattern(
position = position_stack(reverse = TRUE)
)
ggplot(data = all_ves_long |>
filter(Ves_behav == "total_outside" |
Ves_behav == "Total_inside",
npz_id != "SWCMP"),
aes(x = npz_id,
y = ves_counts_diverge,
fill = network,
alpha = Ves_behav)) +
geom_col_pattern(pattern = "stripe",
position = position_stack(reverse = TRUE)
) +
guides(fill = "none")+ # take away fill legend but keep alpha legend
coord_flip()+
scale_y_continuous(limits = c(-200, 800),
breaks = breakvals,
labels = abs(breakvals))+
scale_fill_manual(values = c("Temperate East" = "#00AB8E",
"Northwest" = "#A05EB5",
"South-west" = "#485CC7"))+
scale_alpha_manual(values = c(0.9,0.4),
labels = c(">0.75" , "\u2264 0.75"))+
labs(y = "N vessels",
alpha = "Probability of vessel\nwithin NPZ",
title = "",
fill = NULL) +
facet_nested(rows = vars(network, npz_id, Dep_ID),
nest_line = element_line(),
scales = "free_y",
switch = "y") +
theme(
axis.text.x = element_text(face = "bold"),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
strip.background = element_blank(),
strip.text.y = element_text(face = "bold")
)
ggplot(data = all_ves_long |>
filter(Ves_behav == "total_outside" |
Ves_behav == "Total_inside",
npz_id != "SWCMP"),
aes(x = npz_id,
y = ves_counts_diverge,
fill = network,
alpha = Ves_behav)) +
geom_col_pattern(pattern = "stripe",
position = position_stack(reverse = TRUE)
)
ggplot(data = all_ves_long |>
filter(Ves_behav == "total_outside" |
Ves_behav == "Total_inside",
npz_id != "SWCMP"),
aes(x = npz_id,
y = ves_counts_diverge,
fill = network,
alpha = Ves_behav)) +
geom_col_pattern(aes(pattern_fill = Ves_behav),
position = position_stack(reverse = TRUE)
)
ggplot(data = all_ves_long |>
filter(Ves_behav == "total_outside" |
Ves_behav == "Total_inside",
npz_id != "SWCMP"),
aes(x = npz_id,
y = ves_counts_diverge,
fill = network,
alpha = Ves_behav)) +
geom_col_pattern(aes(pattern_fill = Ves_behav),
position = position_stack(reverse = TRUE)
) +
guides(fill = "none")+ # take away fill legend but keep alpha legend
coord_flip()+
scale_y_continuous(limits = c(-200, 800),
breaks = breakvals,
labels = abs(breakvals))+
scale_fill_manual(values = c("Temperate East" = "#00AB8E",
"Northwest" = "#A05EB5",
"South-west" = "#485CC7"))+
scale_alpha_manual(values = c(0.9,0.4),
labels = c(">0.75" , "\u2264 0.75"))+
labs(y = "N vessels",
alpha = "Probability of vessel\nwithin NPZ",
title = "",
fill = NULL) +
facet_nested(rows = vars(network, npz_id, Dep_ID),
nest_line = element_line(),
scales = "free_y",
switch = "y") +
theme(
axis.text.x = element_text(face = "bold"),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
strip.background = element_blank(),
strip.text.y = element_text(face = "bold")
)
