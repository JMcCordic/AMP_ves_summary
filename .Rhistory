title = "Total vessels")+
facet_nested(rows = vars(network, npz_id, Dep_ID),
nest_line = element_line(),
scales = "free_y") +
theme(
axis.text.x = element_text(face = "bold"),
strip.background = element_blank(),
strip.text.y = element_text(face = "bold")
)
ggplot(data = all_ves_by_site,
aes(x = npz_id,
y = Total_ves_dep,
fill = npz_id)) +
geom_col(show.legend = FALSE,
position = position_identity()) +
scale_fill_viridis_d()+
facet_grid(~network,
scales = "free_x",
space = "free",
drop = TRUE) +
labs(x = "NPZ",
y = "N vessels",
title = "Total vessel counts") +
facet_nested(cols = vars(network, npz_id, Dep_ID),
nest_line = element_line(),
scales = "free_x") +
theme(
axis.text.x = element_text(face = "bold"),
strip.background = element_blank(),
strip.text.y = element_text(face = "bold")
)
View(all_ves_by_day)
all_ves_by_day <- all_sites_hp |>
group_by(network, npz_id, Site_ID, Dep_ID, Dep, Begin_Date_loc) |>
summarise(n_hrs = n_distinct(Begin_Hour_loc),
Total_ves_dep = sum(Total_Vessels, na.rm = TRUE),
Total_inside = sum(total_inside, na.rm = TRUE),
Total_inside_small = sum(total_inside_small, na.rm = TRUE),
Inside_maneuver = sum(man_inside, na.rm = TRUE),
Inside_maneuver_small = sum(man_inside_small, na.rm = TRUE),
# daily means
mean_total_ves = mean(Total_Vessels),
mean_ins_ves = mean(total_inside),
mean_ins_sm_ves = mean(total_inside_small)) |>
mutate(Inside_transit = Total_inside - Inside_maneuver,
Inside_transit_small = Total_inside_small - Inside_maneuver_small)
all_ves_by_day <- all_sites_hp |>
group_by(network, npz_id, Site_ID, Dep_ID, Dep, Begin_Date_loc) |>
summarise(n_hrs = n_distinct(Begin_Hour_loc),
Total_ves_dep = sum(Total_Vessels, na.rm = TRUE),
Total_inside = sum(total_inside, na.rm = TRUE),
Total_inside_small = sum(total_inside_small, na.rm = TRUE),
Inside_maneuver = sum(man_inside, na.rm = TRUE),
Inside_maneuver_small = sum(man_inside_small, na.rm = TRUE),
# daily means
mean_total_ves = mean(Total_Vessels),
mean_ins_ves = mean(total_inside),
mean_ins_sm_ves = mean(total_inside_small)) |>
mutate(total_prophr = Total_ves_dep/n_hrs,
Inside_transit = Total_inside - Inside_maneuver,
Inside_transit_small = Total_inside_small - Inside_maneuver_small)
View(all_sites_hp)
all_ves_by_day <- all_sites_hp |>
group_by(network, npz_id, Site_ID, Dep_ID, Dep, Date_week, Begin_Date_loc) |>
summarise(n_hrs = n_distinct(Begin_Hour_loc),
Total_ves_dep = sum(Total_Vessels, na.rm = TRUE),
Total_inside = sum(total_inside, na.rm = TRUE),
Total_inside_small = sum(total_inside_small, na.rm = TRUE),
Inside_maneuver = sum(man_inside, na.rm = TRUE),
Inside_maneuver_small = sum(man_inside_small, na.rm = TRUE),
# daily means
mean_total_ves = mean(Total_Vessels),
mean_ins_ves = mean(total_inside),
mean_ins_sm_ves = mean(total_inside_small)) |>
mutate(total_prophr = Total_ves_dep/n_hrs,
Inside_transit = Total_inside - Inside_maneuver,
Inside_transit_small = Total_inside_small - Inside_maneuver_small)
all_ves_by_day_noyr <- all_sites_hp |>
group_by(network, npz_id, Site_ID, Dep_ID, Dep, Date_week, Date_noyr) |>
summarise(n_hrs = n_distinct(Begin_Hour_loc),
Total_ves_dep = sum(Total_Vessels, na.rm = TRUE),
Total_inside = sum(total_inside, na.rm = TRUE),
Total_inside_small = sum(total_inside_small, na.rm = TRUE),
Inside_maneuver = sum(man_inside, na.rm = TRUE),
Inside_maneuver_small = sum(man_inside_small, na.rm = TRUE),
# daily means
mean_total_ves = mean(Total_Vessels),
mean_ins_ves = mean(total_inside),
mean_ins_sm_ves = mean(total_inside_small)) |>
mutate(total_prophr = Total_ves_dep/n_hrs,
Inside_transit = Total_inside - Inside_maneuver,
Inside_transit_small = Total_inside_small - Inside_maneuver_small)
ggplot(data = all_ves_by_day,
aes(x = Date_week,
y = total_prophr)) +
geom_boxplot() +
facet_nested(cols = vars(network, npz_id, Dep_ID),
nest_line = element_line(),
scales = "free_x") +
theme(
axis.text.x = element_text(face = "bold"),
strip.background = element_blank(),
strip.text.y = element_text(face = "bold")
)
ggplot(data = all_ves_by_day,
aes(x = Date_week,
y = total_prophr)) +
geom_boxplot() +
facet_nested(rows = vars(network, npz_id, Dep_ID),
nest_line = element_line(),
scales = "free_x") +
theme(
axis.text.x = element_text(face = "bold"),
strip.background = element_blank(),
strip.text.y = element_text(face = "bold")
)
ggplot(data = all_ves_by_day,
aes(x = factor(Date_week),
y = total_prophr)) +
geom_boxplot() +
facet_nested(rows = vars(network, npz_id, Dep_ID),
nest_line = element_line(),
scales = "free_x") +
theme(
axis.text.x = element_text(face = "bold"),
strip.background = element_blank(),
strip.text.y = element_text(face = "bold")
)
ggplot(data = all_ves_by_day,
aes(x = factor(Date_week),
y = total_prophr)) +
geom_boxplot() +
facet_nested(rows = vars(network),
nest_line = element_line(),
scales = "free_x") +
theme(
axis.text.x = element_text(face = "bold"),
strip.background = element_blank(),
strip.text.y = element_text(face = "bold")
)
ggplot(data = all_ves_by_day,
aes(x = factor(Date_week),
y = total_prophr)) +
geom_boxplot() +
facet_nested(rows = vars(network, npz_id),
nest_line = element_line(),
scales = "free_x") +
theme(
axis.text.x = element_text(face = "bold"),
strip.background = element_blank(),
strip.text.y = element_text(face = "bold")
)
ggplot(data = all_ves_by_day,
aes(x = factor(Date_week),
y = total_prophr)) +
geom_boxplot(aes(fill = Dep_ID)) +
facet_nested(rows = vars(network, npz_id),
nest_line = element_line(),
scales = "free_x") +
theme(
axis.text.x = element_text(face = "bold"),
strip.background = element_blank(),
strip.text.y = element_text(face = "bold")
)
geom_boxplot(aes(fill = factor(Dep_ID)) +
ggplot(data = all_ves_by_day,
aes(x = factor(Date_week),
y = total_prophr)) +
geom_boxplot(aes(fill = factor(Dep_ID))) +
facet_nested(rows = vars(network, npz_id),
nest_line = element_line(),
scales = "free_x") +
theme(
axis.text.x = element_text(face = "bold"),
strip.background = element_blank(),
strip.text.y = element_text(face = "bold")
)
ggplot(data = all_ves_by_day,
aes(x = factor(Date_week),
y = total_prophr)) +
geom_boxplot(aes(fill = factor(Dep_ID))) +
facet_nested(rows = vars(network, npz_id, Dep_ID),
nest_line = element_line(),
scales = "free_x") +
theme(
axis.text.x = element_text(face = "bold"),
strip.background = element_blank(),
strip.text.y = element_text(face = "bold")
)
ggplot(data = all_ves_by_day,
aes(x = factor(Date_week),
y = total_prophr)) +
geom_boxplot(aes(fill = factor(Dep_ID))) +
facet_nested(rows = vars(network, npz_id),
nest_line = element_line(),
scales = "free_x") +
theme(
axis.text.x = element_text(face = "bold"),
strip.background = element_blank(),
strip.text.y = element_text(face = "bold")
)
ggplot(data = all_ves_by_day,
aes(x = as_date(Date_week),
y = total_prophr)) +
geom_boxplot(aes(fill = factor(Dep_ID))) +
facet_nested(rows = vars(network, npz_id),
nest_line = element_line(),
scales = "free_x") +
theme(
axis.text.x = element_text(face = "bold"),
strip.background = element_blank(),
strip.text.y = element_text(face = "bold")
)
ggplot(data = all_ves_by_day |> filter(total_prophr > 0),
aes(x = as_date(Date_week),
y = total_prophr)) +
geom_boxplot(aes(fill = factor(Dep_ID))) +
facet_nested(rows = vars(network, npz_id),
nest_line = element_line(),
scales = "free_x") +
theme(
axis.text.x = element_text(face = "bold"),
strip.background = element_blank(),
strip.text.y = element_text(face = "bold")
)
ggplot(data = all_ves_by_day |> filter(total_prophr > 0),
aes(x = as_date(Date_week),
y = total_prophr)) +
geom_boxplot() +
facet_nested(rows = vars(network, npz_id),
nest_line = element_line(),
scales = "free_x") +
theme(
axis.text.x = element_text(face = "bold"),
strip.background = element_blank(),
strip.text.y = element_text(face = "bold")
)
geom_boxplot(aes(group = as_date(Date_week)) +
ggplot(data = all_ves_by_day |> filter(total_prophr > 0),
aes(x = as_date(Date_week),
y = total_prophr)) +
geom_boxplot(aes(group = as_date(Date_week))) +
facet_nested(rows = vars(network, npz_id),
nest_line = element_line(),
scales = "free_x") +
theme(
axis.text.x = element_text(face = "bold"),
strip.background = element_blank(),
strip.text.y = element_text(face = "bold")
)
ggplot(data = all_ves_by_day |> filter(total_prophr > 0),
aes(x = as_date(Date_noyr),
y = total_prophr)) +
geom_boxplot(aes(group = as_date(Date_week))) +
facet_nested(rows = vars(network, npz_id),
nest_line = element_line(),
scales = "free_x") +
theme(
axis.text.x = element_text(face = "bold"),
strip.background = element_blank(),
strip.text.y = element_text(face = "bold")
)
ggplot(data = all_ves_by_day_noyr |> filter(total_prophr > 0),
aes(x = as_date(Date_noyr),
y = total_prophr)) +
geom_boxplot(aes(group = as_date(Date_week))) +
facet_nested(rows = vars(network, npz_id),
nest_line = element_line(),
scales = "free_x") +
theme(
axis.text.x = element_text(face = "bold"),
strip.background = element_blank(),
strip.text.y = element_text(face = "bold")
)
ggplot(data = all_ves_by_day_noyr |> filter(total_prophr > 0),
aes(x = as_date(Date_noyr),
y = total_prophr)) +
geom_boxplot(aes(group = as_date(Date_week),
fill = network)) +
facet_nested(rows = vars(network, npz_id),
nest_line = element_line(),
scales = "free_x") +
theme(
axis.text.x = element_text(face = "bold"),
strip.background = element_blank(),
strip.text.y = element_text(face = "bold")
)
all_ves_by_day_noyr <- all_sites_hp |>
group_by(network, npz_id, Site_ID, Dep_ID, Dep, Date_week, Date_noyr) |>
summarise(n_hrs = n_distinct(Begin_Hour_loc),
Total_ves_dep = sum(Total_Vessels, na.rm = TRUE),
Total_inside = sum(total_inside, na.rm = TRUE),
Total_inside_small = sum(total_inside_small, na.rm = TRUE),
Inside_maneuver = sum(man_inside, na.rm = TRUE),
Inside_maneuver_small = sum(man_inside_small, na.rm = TRUE),
# daily means
mean_total_ves = mean(Total_Vessels),
mean_ins_ves = mean(total_inside),
mean_ins_sm_ves = mean(total_inside_small)) |>
mutate(total_prophr = Total_ves_dep/n_hrs,
Inside_transit = Total_inside - Inside_maneuver,
Inside_transit_small = Total_inside_small - Inside_maneuver_small,
network = case_when(npz_id == "CGMP" | npz_id == "SIMP" ~ "Temperate East",
npz_id == "DMP" | npz_id == "NMP" ~ "Northwest", TRUE ~ "South-west"
),
network = factor(network, levels = c("Temperate East","Northwest","South-west")))
ggplot(data = all_ves_by_day_noyr |> filter(total_prophr > 0),
aes(x = as_date(Date_noyr),
y = total_prophr)) +
geom_boxplot(aes(group = as_date(Date_week),
fill = network)) +
facet_nested(rows = vars(network, npz_id),
nest_line = element_line(),
scales = "free_x") +
theme(
axis.text.x = element_text(face = "bold"),
strip.background = element_blank(),
strip.text.y = element_text(face = "bold")
)
ggplot(data = all_ves_by_day_noyr |> filter(total_prophr > 0),
aes(x = as_date(Date_noyr),
y = total_prophr)) +
geom_boxplot(aes(group = as_date(Date_week),
fill = network),
show.legend = FALSE) +
facet_nested(rows = vars(network, npz_id),
nest_line = element_line(),
scales = "free_x") +
theme(
axis.text.x = element_text(face = "bold"),
strip.background = element_blank(),
strip.text.y = element_text(face = "bold")
)
View(all_ves_by_day_noyr)
# weekly plots for nominal year
ggplot(data = all_ves_by_day_noyr |> filter(total_prophr > 0),
aes(x = as_date(Date_noyr),
y = total_prophr)) +
geom_boxplot(aes(group = as_date(Date_week),
fill = network),
show.legend = FALSE) +
labs(y = "N vessels / hour / day",
x = "Date")+
facet_nested(rows = vars(network, npz_id),
nest_line = element_line(),
scales = "free_x") +
theme(
axis.text.x = element_text(face = "bold"),
strip.background = element_blank(),
strip.text.y = element_text(face = "bold")
)
all_ves_by_day <- all_sites_hp |>
group_by(network, npz_id, Site_ID, Dep_ID, Dep, Date_week, Begin_Date_loc) |>
summarise(n_hrs = n_distinct(Begin_Hour_loc),
n_ves_hrs = sum(ifelse(ves_yn == "Y", 1, 0), na.rm = TRUE),
Total_ves_dep = sum(Total_Vessels, na.rm = TRUE),
Total_inside = sum(total_inside, na.rm = TRUE),
Total_inside_small = sum(total_inside_small, na.rm = TRUE),
Inside_maneuver = sum(man_inside, na.rm = TRUE),
Inside_maneuver_small = sum(man_inside_small, na.rm = TRUE),
# daily means
mean_total_ves = mean(Total_Vessels),
mean_ins_ves = mean(total_inside),
mean_ins_sm_ves = mean(total_inside_small)) |>
mutate(total_prophr = Total_ves_dep/n_hrs,
Inside_transit = Total_inside - Inside_maneuver,
Inside_transit_small = Total_inside_small - Inside_maneuver_small)
all_ves_by_day <- all_sites_hp |>
group_by(network, npz_id, Site_ID, Dep_ID, Dep, Date_week, Begin_Date_loc) |>
summarise(n_hrs = n_distinct(Begin_Hour_loc),
n_ves_hrs = sum(ifelse(ves_yn == "Y", 1, 0), na.rm = TRUE),
Total_ves_dep = sum(Total_Vessels, na.rm = TRUE),
Total_inside = sum(total_inside, na.rm = TRUE),
Total_inside_small = sum(total_inside_small, na.rm = TRUE),
Inside_maneuver = sum(man_inside, na.rm = TRUE),
Inside_maneuver_small = sum(man_inside_small, na.rm = TRUE),
# daily means
mean_total_ves = mean(Total_Vessels),
mean_ins_ves = mean(total_inside),
mean_ins_sm_ves = mean(total_inside_small)) |>
mutate(daily_ves_perhr = Total_ves_dep/n_hrs,
total_prophr = n_ves_hrs/n_hrs,
Inside_transit = Total_inside - Inside_maneuver,
Inside_transit_small = Total_inside_small - Inside_maneuver_small)
all_ves_by_day_noyr <- all_sites_hp |>
group_by(network, npz_id, Site_ID, Dep_ID, Dep, Date_week, Date_noyr) |>
summarise(n_hrs = n_distinct(Begin_Hour_loc),
n_ves_hrs = sum(ifelse(ves_yn == "Y", 1, 0), na.rm = TRUE),
Total_ves_dep = sum(Total_Vessels, na.rm = TRUE),
Total_inside = sum(total_inside, na.rm = TRUE),
Total_inside_small = sum(total_inside_small, na.rm = TRUE),
Inside_maneuver = sum(man_inside, na.rm = TRUE),
Inside_maneuver_small = sum(man_inside_small, na.rm = TRUE),
# daily means
mean_total_ves = mean(Total_Vessels),
mean_ins_ves = mean(total_inside),
mean_ins_sm_ves = mean(total_inside_small)) |>
mutate(daily_ves_perhr = Total_ves_dep/n_hrs,
total_prophr = n_ves_hrs/n_hrs,
Inside_transit = Total_inside - Inside_maneuver,
Inside_transit_small = Total_inside_small - Inside_maneuver_small,
network = case_when(npz_id == "CGMP" | npz_id == "SIMP" ~ "Temperate East",
npz_id == "DMP" | npz_id == "NMP" ~ "Northwest", TRUE ~ "South-west"
),
network = factor(network, levels = c("Temperate East","Northwest","South-west")))
# weekly plots for nominal year
ggplot(data = all_ves_by_day_noyr |> filter(total_prophr > 0),
aes(x = as_date(Date_noyr),
y = total_prophr)) +
geom_boxplot(aes(group = as_date(Date_week),
fill = network),
show.legend = FALSE) +
labs(y = "N vessels / hour / day",
x = "Date")+
facet_nested(rows = vars(network, npz_id),
nest_line = element_line(),
scales = "free_x") +
theme(
axis.text.x = element_text(face = "bold"),
strip.background = element_blank(),
strip.text.y = element_text(face = "bold")
)
# weekly plots for nominal year
ggplot(data = all_ves_by_day_noyr |> filter(total_prophr > 0),
aes(x = as_date(Date_noyr),
y = total_prophr)) +
geom_boxplot(aes(group = as_date(Date_week),
fill = network),
show.legend = FALSE) +
labs(y = "Proportion hours with vessels",
x = "Date")+
facet_nested(rows = vars(network, npz_id),
nest_line = element_line(),
scales = "free_x") +
theme(
axis.text.x = element_text(face = "bold"),
strip.background = element_blank(),
strip.text.y = element_text(face = "bold")
)
# weekly plots for nominal year
ggplot(data = all_ves_by_day_noyr |> filter(total_prophr > 0),
aes(x = as_date(Date_noyr),
y = total_prophr)) +
geom_boxplot(aes(group = as_date(Date_week),
fill = network),
show.legend = FALSE) +
labs(y = "N hours present /\nN total hours",
x = "Date")+
facet_nested(rows = vars(network, npz_id),
nest_line = element_line(),
scales = "free_x") +
theme(
axis.text.x = element_text(face = "bold"),
strip.background = element_blank(),
strip.text.y = element_text(face = "bold")
)
# weekly plots for nominal year
ggplot(data = all_ves_by_day_noyr |> filter(total_prophr > 0),
aes(x = as_date(Date_noyr),
y = total_prophr)) +
geom_boxplot(aes(group = as_date(Date_week),
fill = network),
show.legend = FALSE) +
scale_x_date(date_breaks = "months")+
labs(y = "N hours present /\nN total hours",
x = "Date")+
facet_nested(rows = vars(network, npz_id),
nest_line = element_line(),
scales = "free_x") +
theme(
axis.text.x = element_text(face = "bold"),
strip.background = element_blank(),
strip.text.y = element_text(face = "bold")
)
# weekly plots for nominal year
ggplot(data = all_ves_by_day_noyr |> filter(total_prophr > 0),
aes(x = as_date(Date_noyr),
y = total_prophr)) +
geom_boxplot(aes(group = as_date(Date_week),
fill = network),
show.legend = FALSE) +
scale_x_date(date_breaks = "months", format = "%b")+
labs(y = "N hours present /\nN total hours",
x = "Date")+
facet_nested(rows = vars(network, npz_id),
nest_line = element_line(),
scales = "free_x") +
theme(
axis.text.x = element_text(face = "bold"),
strip.background = element_blank(),
strip.text.y = element_text(face = "bold")
)
# weekly plots for nominal year
ggplot(data = all_ves_by_day_noyr |> filter(total_prophr > 0),
aes(x = as_date(Date_noyr),
y = total_prophr)) +
geom_boxplot(aes(group = as_date(Date_week),
fill = network),
show.legend = FALSE) +
scale_x_date(date_breaks = "months", date_labels = "%b")+
labs(y = "N hours present /\nN total hours",
x = "Date")+
facet_nested(rows = vars(network, npz_id),
nest_line = element_line(),
scales = "free_x") +
theme(
axis.text.x = element_text(face = "bold"),
strip.background = element_blank(),
strip.text.y = element_text(face = "bold")
)
ggsave(paste0("figs/", "Total_boxplot_daily_prophr_1yr.png"), width=10, height=8,
units="in", dpi=300)
