Hr_local = as_datetime(Hr_local)
# mydt_new = map2(Hr_local, tz_local, ~ymd_hms(.x, tz = .y))
# Hr_local_tz = force_tz(Hr_local, tzone = tz_local)
) |>
ungroup()
# start by getting counts per light regime
all_ves_light <- all_sites_hp |>
#suncalc package needs time zone
mutate(tz_local = case_when(
Dep == "CGMP_201807_CG" | Dep == "CGMP_201904_CG" | Dep == "SIMP_201808_EP" | Dep == "SIMP_201808_WP" |
Dep == "SIMP_201906_EP" | Dep == "SIMP_201906_WP" |
Dep == "MURAT_202002_MRE" | Dep == "MURAT_202002_MRW" ~ "Etc/GMT-10",
Dep == "CGMP_201812_CG" |
Dep == "SIMP_201812_EP" | Dep == "SIMP_201812_WP" ~ "Etc/GMT-11",
TRUE ~ "Etc/GMT-8"
)) |>
group_by(tz_local) |>
rowwise() |>
mutate(
Hr_local = as_datetime(Hr_local),
mydt_new = ymd_hms(Hr_local, tz = tz_local[[1]])
# Hr_local_tz = force_tz(Hr_local, tzone = tz_local)
) |>
ungroup()
# start by getting counts per light regime
all_ves_light <- all_sites_hp |>
#suncalc package needs time zone
mutate(tz_local = case_when(
Dep == "CGMP_201807_CG" | Dep == "CGMP_201904_CG" | Dep == "SIMP_201808_EP" | Dep == "SIMP_201808_WP" |
Dep == "SIMP_201906_EP" | Dep == "SIMP_201906_WP" |
Dep == "MURAT_202002_MRE" | Dep == "MURAT_202002_MRW" ~ "Etc/GMT-10",
Dep == "CGMP_201812_CG" |
Dep == "SIMP_201812_EP" | Dep == "SIMP_201812_WP" ~ "Etc/GMT-11",
TRUE ~ "Etc/GMT-8"
)) |>
group_by(tz_local) |>
# rowwise() |>
mutate(
Hr_local = as_datetime(Hr_local),
mydt_new = ymd_hms(Hr_local, tz = tz_local[[1]])
# Hr_local_tz = force_tz(Hr_local, tzone = tz_local)
) |>
ungroup()
tz_local[[1]]
all_ves_light$tz_local[[1]]
ymd_hms(all_ves_light$Hr_local[5], tz = all_ves_light$tz_local[5])
ymd_hms(all_ves_light$Hr_local[5], tz = all_ves_light$tz_local[892])
dplyr::last_dplyr_warnings()
View(all_ves_light)
# start by getting counts per light regime
all_ves_light <- all_sites_hp |>
#suncalc package needs time zone
mutate(tz_local = case_when(
Dep == "CGMP_201807_CG" | Dep == "CGMP_201904_CG" | Dep == "SIMP_201808_EP" | Dep == "SIMP_201808_WP" |
Dep == "SIMP_201906_EP" | Dep == "SIMP_201906_WP" |
Dep == "MURAT_202002_MRE" | Dep == "MURAT_202002_MRW" ~ "Etc/GMT-10",
Dep == "CGMP_201812_CG" |
Dep == "SIMP_201812_EP" | Dep == "SIMP_201812_WP" ~ "Etc/GMT-11",
TRUE ~ "Etc/GMT-8"
)) |>
group_by(tz_local) |>
# rowwise() |>
mutate(
Hr_local = as_datetime(Hr_local),
mydt_new = ymd_hms(Hr_local, tz = tz_local[[1]])
# Hr_local_tz = force_tz(Hr_local, tzone = tz_local)
) |>
ungroup()
tz(all_ves_light$mydt_new)
tz(all_ves_light$mydt_new[892])
all_ves_light <- all_sites_hp |>
#suncalc package needs time zone
mutate(tz_local = case_when(
Dep == "CGMP_201807_CG" | Dep == "CGMP_201904_CG" | Dep == "SIMP_201808_EP" | Dep == "SIMP_201808_WP" |
Dep == "SIMP_201906_EP" | Dep == "SIMP_201906_WP" |
Dep == "MURAT_202002_MRE" | Dep == "MURAT_202002_MRW" ~ "Etc/GMT-10",
Dep == "CGMP_201812_CG" |
Dep == "SIMP_201812_EP" | Dep == "SIMP_201812_WP" ~ "Etc/GMT-11",
TRUE ~ "Etc/GMT-8"
)) |>
group_split(tz_local)
View(all_ves_light)
# start by getting counts per light regime
all_ves_light <- all_sites_hp |>
#suncalc package needs time zone
mutate(tz_local = case_when(
Dep == "CGMP_201807_CG" | Dep == "CGMP_201904_CG" | Dep == "SIMP_201808_EP" | Dep == "SIMP_201808_WP" |
Dep == "SIMP_201906_EP" | Dep == "SIMP_201906_WP" |
Dep == "MURAT_202002_MRE" | Dep == "MURAT_202002_MRW" ~ "Etc/GMT-10",
Dep == "CGMP_201812_CG" |
Dep == "SIMP_201812_EP" | Dep == "SIMP_201812_WP" ~ "Etc/GMT-11",
TRUE ~ "Etc/GMT-8"
)) |>
nest_by(tz_local) |>
# rowwise() |>
mutate(
Hr_local = as_datetime(Hr_local),
mydt_new = ymd_hms(Hr_local, tz = tz_local[[1]])
# Hr_local_tz = force_tz(Hr_local, tzone = tz_local)
) |>
ungroup()
# start by getting counts per light regime
all_ves_light <- all_sites_hp |>
#suncalc package needs time zone
mutate(tz_local = case_when(
Dep == "CGMP_201807_CG" | Dep == "CGMP_201904_CG" | Dep == "SIMP_201808_EP" | Dep == "SIMP_201808_WP" |
Dep == "SIMP_201906_EP" | Dep == "SIMP_201906_WP" |
Dep == "MURAT_202002_MRE" | Dep == "MURAT_202002_MRW" ~ "Etc/GMT-10",
Dep == "CGMP_201812_CG" |
Dep == "SIMP_201812_EP" | Dep == "SIMP_201812_WP" ~ "Etc/GMT-11",
TRUE ~ "Etc/GMT-8"
)) |>
rowwise() |>
mutate(
Hr_local = as_datetime(Hr_local),
Hr_local_tz = force_tz(Hr_local, tzone = tz_local)
) |>
ungroup()
tz(all_ves_light$Hr_local_tz)
tz(all_ves_light$Hr_local_tz[8882])
# start by getting counts per light regime
all_ves_light <- all_sites_hp |>
#suncalc package needs time zone
mutate(tz_local = case_when(
Dep == "CGMP_201807_CG" | Dep == "CGMP_201904_CG" | Dep == "SIMP_201808_EP" | Dep == "SIMP_201808_WP" |
Dep == "SIMP_201906_EP" | Dep == "SIMP_201906_WP" |
Dep == "MURAT_202002_MRE" | Dep == "MURAT_202002_MRW" ~ "Etc/GMT-10",
Dep == "CGMP_201812_CG" |
Dep == "SIMP_201812_EP" | Dep == "SIMP_201812_WP" ~ "Etc/GMT-11",
TRUE ~ "Etc/GMT-8"
)) |>
rowwise() |>
mutate(
Hr_local = as_datetime(Hr_local),
Hr_local_tz = force_tz(Hr_local, tzone = tz_local[[1]])
) |>
ungroup()
tz(all_ves_light$Hr_local_tz[8882])
tz(all_ves_light$Dep[8882])
all_ves_light$Dep[8882]
# start by getting counts per light regime
all_ves_light <- all_sites_hp |>
#suncalc package needs time zone
mutate(tz_local = case_when(
Dep == "CGMP_201807_CG" | Dep == "CGMP_201904_CG" | Dep == "SIMP_201808_EP" | Dep == "SIMP_201808_WP" |
Dep == "SIMP_201906_EP" | Dep == "SIMP_201906_WP" |
Dep == "MURAT_202002_MRE" | Dep == "MURAT_202002_MRW" ~ "Etc/GMT-10",
Dep == "CGMP_201812_CG" |
Dep == "SIMP_201812_EP" | Dep == "SIMP_201812_WP" ~ "Etc/GMT-11",
TRUE ~ "Etc/GMT-8"
)) |>
rowwise(tz_local) |>
mutate(
Hr_local = as_datetime(Hr_local),
Hr_local_tz = force_tz(Hr_local, tzone = tz_local[[1]])
) |>
ungroup()
all_ves_light$Dep[8882]
tz(all_ves_light$Dep[8882])
tz(all_ves_light$Hr_local_tz[8882])
# start by getting counts per light regime
all_ves_light <- all_sites_hp |>
#suncalc package needs time zone
mutate(tz_local = case_when(
Dep == "CGMP_201807_CG" | Dep == "CGMP_201904_CG" | Dep == "SIMP_201808_EP" | Dep == "SIMP_201808_WP" |
Dep == "SIMP_201906_EP" | Dep == "SIMP_201906_WP" |
Dep == "MURAT_202002_MRE" | Dep == "MURAT_202002_MRW" ~ "Etc/GMT-10",
Dep == "CGMP_201812_CG" |
Dep == "SIMP_201812_EP" | Dep == "SIMP_201812_WP" ~ "Etc/GMT-11",
TRUE ~ "Etc/GMT-8"
)) |>
rowwise(tz_local) |>
mutate(
Hr_local = ymd_hms(Hr_local, format = "%Y-%m-%d %H:%M:%S"),
Hr_local_tz = force_tz(Hr_local, tzone = tz_local[[1]])
) |>
ungroup()
# start by getting counts per light regime
all_ves_light <- all_sites_hp |>
#suncalc package needs time zone
mutate(tz_local = case_when(
Dep == "CGMP_201807_CG" | Dep == "CGMP_201904_CG" | Dep == "SIMP_201808_EP" | Dep == "SIMP_201808_WP" |
Dep == "SIMP_201906_EP" | Dep == "SIMP_201906_WP" |
Dep == "MURAT_202002_MRE" | Dep == "MURAT_202002_MRW" ~ "Etc/GMT-10",
Dep == "CGMP_201812_CG" |
Dep == "SIMP_201812_EP" | Dep == "SIMP_201812_WP" ~ "Etc/GMT-11",
TRUE ~ "Etc/GMT-8"
)) |>
rowwise(tz_local) |>
mutate(
Hr_local = ymd_hms(Hr_local, format = "%Y-%m-%d %H:%M:%S", tz = tz_local),
Hr_local_tz = force_tz(Hr_local, tzone = tz_local[[1]])
) |>
ungroup()
# start by getting counts per light regime
all_ves_light <- all_sites_hp |>
#suncalc package needs time zone
mutate(tz_local = case_when(
Dep == "CGMP_201807_CG" | Dep == "CGMP_201904_CG" | Dep == "SIMP_201808_EP" | Dep == "SIMP_201808_WP" |
Dep == "SIMP_201906_EP" | Dep == "SIMP_201906_WP" |
Dep == "MURAT_202002_MRE" | Dep == "MURAT_202002_MRW" ~ "Etc/GMT-10",
Dep == "CGMP_201812_CG" |
Dep == "SIMP_201812_EP" | Dep == "SIMP_201812_WP" ~ "Etc/GMT-11",
TRUE ~ "Etc/GMT-8"
)) |>
mutate(
Hr_local = ymd_hms(Hr_local, format = "%Y-%m-%d %H:%M:%S", tz = tz_local),
Hr_local_tz = force_tz(Hr_local, tzone = tz_local[[1]])
) |>
ungroup()
# start by getting counts per light regime
all_ves_light <- all_sites_hp |>
#suncalc package needs time zone
mutate(tz_local = case_when(
Dep == "CGMP_201807_CG" | Dep == "CGMP_201904_CG" | Dep == "SIMP_201808_EP" | Dep == "SIMP_201808_WP" |
Dep == "SIMP_201906_EP" | Dep == "SIMP_201906_WP" |
Dep == "MURAT_202002_MRE" | Dep == "MURAT_202002_MRW" ~ "Etc/GMT-10",
Dep == "CGMP_201812_CG" |
Dep == "SIMP_201812_EP" | Dep == "SIMP_201812_WP" ~ "Etc/GMT-11",
TRUE ~ "Etc/GMT-8"
)) |>
group_by(tz_local)|>
mutate(
Hr_local = ymd_hms(Hr_local, format = "%Y-%m-%d %H:%M:%S", tz = tz_local[[1]]),
Hr_local_tz = force_tz(Hr_local, tzone = tz_local[[1]])
) |>
ungroup()
# start by getting counts per light regime
all_ves_light <- all_sites_hp |>
#suncalc package needs time zone
mutate(tz_local = case_when(
Dep == "CGMP_201807_CG" | Dep == "CGMP_201904_CG" | Dep == "SIMP_201808_EP" | Dep == "SIMP_201808_WP" |
Dep == "SIMP_201906_EP" | Dep == "SIMP_201906_WP" |
Dep == "MURAT_202002_MRE" | Dep == "MURAT_202002_MRW" ~ "Etc/GMT-10",
Dep == "CGMP_201812_CG" |
Dep == "SIMP_201812_EP" | Dep == "SIMP_201812_WP" ~ "Etc/GMT-11",
TRUE ~ "Etc/GMT-8"
)) |>
group_by(tz_local)|>
mutate(
Hr_local_tz = force_tz(Hr_local, tzone = tz_local[[1]])
) |>
ungroup()
tz(all_ves_light$Hr_local_tz[8882])
all_ves_light <- all_sites_hp |>
#suncalc package needs time zone
mutate(Hr_local_tz = case_when(
Dep == "CGMP_201807_CG" | Dep == "CGMP_201904_CG" | Dep == "SIMP_201808_EP" | Dep == "SIMP_201808_WP" |
Dep == "SIMP_201906_EP" | Dep == "SIMP_201906_WP" |
Dep == "MURAT_202002_MRE" | Dep == "MURAT_202002_MRW" ~ force_tz(Hr_local, tzone = "Etc/GMT-10"),
Dep == "CGMP_201812_CG" |
Dep == "SIMP_201812_EP" | Dep == "SIMP_201812_WP" ~ force_tz(Hr_local, tzone = "Etc/GMT-11"),
TRUE ~ force_tz(Hr_local, tzone "Etc/GMT-8")
all_ves_light <- all_sites_hp |>
#suncalc package needs time zone
mutate(
Hr_local_tz = case_when(
Dep == "CGMP_201807_CG" | Dep == "CGMP_201904_CG" | Dep == "SIMP_201808_EP" | Dep == "SIMP_201808_WP" |
Dep == "SIMP_201906_EP" | Dep == "SIMP_201906_WP" |
Dep == "MURAT_202002_MRE" | Dep == "MURAT_202002_MRW" ~ force_tz(Hr_local, tzone = "Etc/GMT-10"),
Dep == "CGMP_201812_CG" |
Dep == "SIMP_201812_EP" | Dep == "SIMP_201812_WP" ~ force_tz(Hr_local, tzone = "Etc/GMT-11"),
TRUE ~ force_tz(Hr_local, tzone "Etc/GMT-8")
# start by getting counts per light regime
all_ves_light <- all_sites_hp |>
#suncalc package needs time zone
mutate(
Hr_local_tz = case_when(
Dep == "CGMP_201807_CG" | Dep == "CGMP_201904_CG" | Dep == "SIMP_201808_EP" | Dep == "SIMP_201808_WP" |
Dep == "SIMP_201906_EP" | Dep == "SIMP_201906_WP" |
Dep == "MURAT_202002_MRE" | Dep == "MURAT_202002_MRW" ~ force_tz(Hr_local, tzone = "Etc/GMT-10"),
Dep == "CGMP_201812_CG" |
Dep == "SIMP_201812_EP" | Dep == "SIMP_201812_WP" ~ force_tz(Hr_local, tzone = "Etc/GMT-11")
# TRUE ~ force_tz(Hr_local, tzone "Etc/GMT-8")
)
)
View(all_ves_light)
tz(all_ves_light$Hr_local_tz[892])
all_ves_light$Hr_local_tz[892]
all_ves_light$Dep[892]
# start by getting counts per light regime
all_ves_light <- all_sites_hp |>
#suncalc package needs time zone
mutate(
Hr_local_tz = case_when(
Dep == "CGMP_201807_CG" | Dep == "CGMP_201904_CG" | Dep == "SIMP_201808_EP" | Dep == "SIMP_201808_WP" |
Dep == "SIMP_201906_EP" | Dep == "SIMP_201906_WP" |
Dep == "MURAT_202002_MRE" | Dep == "MURAT_202002_MRW" ~ force_tz(Hr_local, tzone = "Etc/GMT-10"),
Dep == "CGMP_201812_CG" |
Dep == "SIMP_201812_EP" | Dep == "SIMP_201812_WP" ~ force_tz(Hr_local, tzone = "Etc/GMT-11"),
TRUE ~ force_tz(Hr_local, tzone "Etc/GMT-8")
# start by getting counts per light regime
all_ves_light <- all_sites_hp |>
#suncalc package needs time zone
mutate(
Hr_local_tz = case_when(
Dep == "CGMP_201807_CG" | Dep == "CGMP_201904_CG" | Dep == "SIMP_201808_EP" | Dep == "SIMP_201808_WP" |
Dep == "SIMP_201906_EP" | Dep == "SIMP_201906_WP" |
Dep == "MURAT_202002_MRE" | Dep == "MURAT_202002_MRW" ~ force_tz(Hr_local, tzone = "Etc/GMT-10")),
Hr_local_tz = case_when(
Dep == "CGMP_201812_CG" |
Dep == "SIMP_201812_EP" | Dep == "SIMP_201812_WP" ~ force_tz(Hr_local, tzone = "Etc/GMT-11"))
# TRUE ~ force_tz(Hr_local, tzone "Etc/GMT-8")
)
all_ves_light$Hr_local_tz[892]
unique(all_ves_light$Dep)
all_ves_light <- all_sites_hp |>
#suncalc package needs time zone
mutate(
Hr_local_tz = case_when(
Dep == "CGMP_201807_CG" | Dep == "CGMP_201904_CG" | Dep == "SIMP_201808_EP" | Dep == "SIMP_201808_WP" |
Dep == "SIMP_201906_EP" | Dep == "SIMP_201906_WP" |
Dep == "MURAT_202002_MRE" | Dep == "MURAT_202002_MRW" ~ force_tz(Hr_local, tzone = "Etc/GMT-10")),
Hr_local_tz = case_when(
Dep == "CGMP_201812_CG" |
Dep == "SIMP_201812_EP" | Dep == "SIMP_201812_WP" ~ force_tz(Hr_local, tzone = "Etc/GMT-11")),
Hr_local_tz = case_when(
Dep == "DAMPIER_202009_DNE" |
Dep == "DAMPIER_202009_DSW" | Dep == "GEOGRAPHE_202201_GEO" | Dep == "JURIEN_202201_JNE"
| Dep == "JURIEN_202201_JSE"| Dep == "NINGALOO_201909_NGN"| Dep == "NINGALOO_201909_NGS"
| Dep == "SWC_202201_SWS"| Dep == "TWOROCKS_202105_TRE"| Dep == "TWOROCKS_202105_TRW" ~ force_tz(Hr_local, tzone = "Etc/GMT-8"))
# TRUE ~ force_tz(Hr_local, tzone "Etc/GMT-8")
)
tz(all_ves_light$Hr_local_tz[8882])
all_ves_light <- all_sites_hp |>
#suncalc package needs time zone
mutate(
Hr_local_tz = case_when(
Dep == "CGMP_201807_CG" | Dep == "CGMP_201904_CG" | Dep == "SIMP_201808_EP" | Dep == "SIMP_201808_WP" |
Dep == "SIMP_201906_EP" | Dep == "SIMP_201906_WP" |
Dep == "MURAT_202002_MRE" | Dep == "MURAT_202002_MRW" ~ force_tz(Hr_local, tzone = "Etc/GMT-10")),
Hr_local_tz = case_when(
Dep == "CGMP_201812_CG" |
Dep == "SIMP_201812_EP" | Dep == "SIMP_201812_WP" ~ force_tz(Hr_local, tzone = "Etc/GMT-11")),
Hr_local_tz = case_when(
Dep == "DAMPIER_202009_DNE" |
Dep == "DAMPIER_202009_DSW" | Dep == "GEOGRAPHE_202201_GEO" | Dep == "JURIEN_202201_JNE"
| Dep == "JURIEN_202201_JSE"| Dep == "NINGALOO_201909_NGN"| Dep == "NINGALOO_201909_NGS"
| Dep == "SWC_202201_SWS"| Dep == "TWOROCKS_202105_TRE"| Dep == "TWOROCKS_202105_TRW" ~ force_tz(Hr_local, tzone = "Etc/GMT-8")),
Begin_Date_UTC = as_date(with_tz(Hr_local_tz, tzone = "UTC"))
)
# start by getting counts per light regime
all_ves_light <- all_sites_hp |>
#suncalc package needs time zone
mutate(
Hr_local_tz = case_when(
Dep == "CGMP_201807_CG" | Dep == "CGMP_201904_CG" | Dep == "SIMP_201808_EP" | Dep == "SIMP_201808_WP" |
Dep == "SIMP_201906_EP" | Dep == "SIMP_201906_WP" |
Dep == "MURAT_202002_MRE" | Dep == "MURAT_202002_MRW" ~ force_tz(Hr_local, tzone = "Etc/GMT-10")),
Hr_local_tz = case_when(
Dep == "CGMP_201812_CG" |
Dep == "SIMP_201812_EP" | Dep == "SIMP_201812_WP" ~ force_tz(Hr_local, tzone = "Etc/GMT-11")),
Hr_local_tz = case_when(
Dep == "DAMPIER_202009_DNE" |
Dep == "DAMPIER_202009_DSW" | Dep == "GEOGRAPHE_202201_GEO" | Dep == "JURIEN_202201_JNE"
| Dep == "JURIEN_202201_JSE"| Dep == "NINGALOO_201909_NGN"| Dep == "NINGALOO_201909_NGS"
| Dep == "SWC_202201_SWS"| Dep == "TWOROCKS_202105_TRE"| Dep == "TWOROCKS_202105_TRW" ~ force_tz(Hr_local, tzone = "Etc/GMT-8")),
Begin_Date_UTC = as_date(with_tz(Hr_local_tz, tzone = "UTC"))
) |>
# get elevation of sun based on GPS location & time
mutate(sun_elev_rad = suncalc::getSunlightPosition(Hr_local_tz,
Lat_DD,
Lon_DD,
keep = "altitude")$altitude,
sun_elev_deg = (sun_elev_rad*180)/(pi),
twilight_times = getSunlightTimes(date = Begin_Date_UTC,
Lat_DD,
Lon_DD,
keep = c("nauticalDawn","sunset"),
tz = "UTC"))
# start by getting counts per light regime
all_ves_light <- all_sites_hp |>
#suncalc package needs time zone
mutate(
Hr_local_tz = case_when(
Dep == "CGMP_201807_CG" | Dep == "CGMP_201904_CG" | Dep == "SIMP_201808_EP" | Dep == "SIMP_201808_WP" |
Dep == "SIMP_201906_EP" | Dep == "SIMP_201906_WP" |
Dep == "MURAT_202002_MRE" | Dep == "MURAT_202002_MRW" ~ force_tz(Hr_local, tzone = "Etc/GMT-10")),
Hr_local_tz = case_when(
Dep == "CGMP_201812_CG" |
Dep == "SIMP_201812_EP" | Dep == "SIMP_201812_WP" ~ force_tz(Hr_local, tzone = "Etc/GMT-11")),
Hr_local_tz = case_when(
Dep == "DAMPIER_202009_DNE" |
Dep == "DAMPIER_202009_DSW" | Dep == "GEOGRAPHE_202201_GEO" | Dep == "JURIEN_202201_JNE"
| Dep == "JURIEN_202201_JSE"| Dep == "NINGALOO_201909_NGN"| Dep == "NINGALOO_201909_NGS"
| Dep == "SWC_202201_SWS"| Dep == "TWOROCKS_202105_TRE"| Dep == "TWOROCKS_202105_TRW" ~ force_tz(Hr_local, tzone = "Etc/GMT-8")),
Begin_Date_UTC = as_date(with_tz(Hr_local_tz, tzone = "UTC"))
) |>
rowwise()|>
# get elevation of sun based on GPS location & time
mutate(sun_elev_rad = suncalc::getSunlightPosition(Hr_local_tz,
Lat_DD,
Lon_DD,
keep = "altitude")$altitude,
sun_elev_deg = (sun_elev_rad*180)/(pi),
twilight_times = getSunlightTimes(date = Begin_Date_UTC,
Lat_DD,
Lon_DD,
keep = c("nauticalDawn","sunset"),
tz = "UTC"))
all_ves_light <- all_sites_hp |>
#suncalc package needs time zone
mutate(
Hr_local_tz = case_when(
Dep == "CGMP_201807_CG" | Dep == "CGMP_201904_CG" | Dep == "SIMP_201808_EP" | Dep == "SIMP_201808_WP" |
Dep == "SIMP_201906_EP" | Dep == "SIMP_201906_WP" |
Dep == "MURAT_202002_MRE" | Dep == "MURAT_202002_MRW" ~ force_tz(Hr_local, tzone = "Etc/GMT-10")),
Hr_local_tz = case_when(
Dep == "CGMP_201812_CG" |
Dep == "SIMP_201812_EP" | Dep == "SIMP_201812_WP" ~ force_tz(Hr_local, tzone = "Etc/GMT-11")),
Hr_local_tz = case_when(
Dep == "DAMPIER_202009_DNE" |
Dep == "DAMPIER_202009_DSW" | Dep == "GEOGRAPHE_202201_GEO" | Dep == "JURIEN_202201_JNE"
| Dep == "JURIEN_202201_JSE"| Dep == "NINGALOO_201909_NGN"| Dep == "NINGALOO_201909_NGS"
| Dep == "SWC_202201_SWS"| Dep == "TWOROCKS_202105_TRE"| Dep == "TWOROCKS_202105_TRW" ~ force_tz(Hr_local, tzone = "Etc/GMT-8")),
Begin_Date_UTC = as_date(with_tz(Hr_local_tz, tzone = "UTC"))
)
all_ves_light <- all_sites_hp |>
#suncalc package needs time zone
mutate(
Hr_local_tz = case_when(
Dep == "CGMP_201807_CG" | Dep == "CGMP_201904_CG" | Dep == "SIMP_201808_EP" | Dep == "SIMP_201808_WP" |
Dep == "SIMP_201906_EP" | Dep == "SIMP_201906_WP" |
Dep == "MURAT_202002_MRE" | Dep == "MURAT_202002_MRW" ~ force_tz(Hr_local, tzone = "Etc/GMT-10"),
Dep == "CGMP_201812_CG" |
Dep == "SIMP_201812_EP" | Dep == "SIMP_201812_WP" ~ force_tz(Hr_local, tzone = "Etc/GMT-11"),
Dep == "DAMPIER_202009_DNE" |
Dep == "DAMPIER_202009_DSW" | Dep == "GEOGRAPHE_202201_GEO" | Dep == "JURIEN_202201_JNE"
| Dep == "JURIEN_202201_JSE"| Dep == "NINGALOO_201909_NGN"| Dep == "NINGALOO_201909_NGS"
| Dep == "SWC_202201_SWS"| Dep == "TWOROCKS_202105_TRE"| Dep == "TWOROCKS_202105_TRW" ~ force_tz(Hr_local, tzone = "Etc/GMT-8")),
Begin_Date_UTC = as_date(with_tz(Hr_local_tz, tzone = "UTC"))
)
tz(all_ves_light$Hr_local_tz[8882])
all_ves_gmt10 <- all_sites_hp |>
filter(Dep == "CGMP_201807_CG" | Dep == "CGMP_201904_CG" | Dep == "SIMP_201808_EP" | Dep == "SIMP_201808_WP" |
Dep == "SIMP_201906_EP" | Dep == "SIMP_201906_WP" |
Dep == "MURAT_202002_MRE" | Dep == "MURAT_202002_MRW") |>
mutate(Hr_local_tz = force_tz(Hr_local, tzone = "Etc/GMT-10"))
all_ves_gmt11 <- all_sites_hp |>
filter(Dep == "CGMP_201812_CG" |
Dep == "SIMP_201812_EP" | Dep == "SIMP_201812_WP") |>
mutate(Hr_local_tz = force_tz(Hr_local, tzone = "Etc/GMT-11"))
all_ves_gmt8 <- all_sites_hp |>
filter(Dep == "DAMPIER_202009_DNE" |
Dep == "DAMPIER_202009_DSW" | Dep == "GEOGRAPHE_202201_GEO" | Dep == "JURIEN_202201_JNE"
| Dep == "JURIEN_202201_JSE"| Dep == "NINGALOO_201909_NGN"| Dep == "NINGALOO_201909_NGS"
| Dep == "SWC_202201_SWS"| Dep == "TWOROCKS_202105_TRE"| Dep == "TWOROCKS_202105_TRW") |>
mutate(Hr_local_tz = force_tz(Hr_local, tzone = "Etc/GMT-8"))
View(all_ves_gmt10)
all_ves_gmt8 <- all_sites_hp |>
filter(Dep == "DAMPIER_202009_DNE" |
Dep == "DAMPIER_202009_DSW" | Dep == "GEOGRAPHE_202201_GEO" | Dep == "JURIEN_202201_JNE"
| Dep == "JURIEN_202201_JSE"| Dep == "NINGALOO_201909_NGN"| Dep == "NINGALOO_201909_NGS"
| Dep == "SWC_202201_SWS"| Dep == "TWOROCKS_202105_TRE"| Dep == "TWOROCKS_202105_TRW") |>
mutate(Hr_local_tz = force_tz(Hr_local, tzone = "Etc/GMT-8")) |>
Begin_Date_UTC = as_date(with_tz(Hr_local_tz, tzone = "UTC"))|>
rowwise()|>
# get elevation of sun based on GPS location & time
mutate(sun_elev_rad = suncalc::getSunlightPosition(Hr_local_tz,
Lat_DD,
Lon_DD,
keep = "altitude")$altitude,
sun_elev_deg = (sun_elev_rad*180)/(pi),
twilight_times = getSunlightTimes(date = Begin_Date_UTC,
Lat_DD,
Lon_DD,
keep = c("nauticalDawn","sunset"),
tz = "UTC"))
all_ves_gmt8 <- all_sites_hp |>
filter(Dep == "DAMPIER_202009_DNE" |
Dep == "DAMPIER_202009_DSW" | Dep == "GEOGRAPHE_202201_GEO" | Dep == "JURIEN_202201_JNE"
| Dep == "JURIEN_202201_JSE"| Dep == "NINGALOO_201909_NGN"| Dep == "NINGALOO_201909_NGS"
| Dep == "SWC_202201_SWS"| Dep == "TWOROCKS_202105_TRE"| Dep == "TWOROCKS_202105_TRW") |>
mutate(Hr_local_tz = force_tz(Hr_local, tzone = "Etc/GMT-8"),
Begin_Date_UTC = as_date(with_tz(Hr_local_tz, tzone = "UTC")))|>
rowwise()|>
# get elevation of sun based on GPS location & time
mutate(sun_elev_rad = suncalc::getSunlightPosition(Hr_local_tz,
Lat_DD,
Lon_DD,
keep = "altitude")$altitude,
sun_elev_deg = (sun_elev_rad*180)/(pi),
twilight_times = getSunlightTimes(date = Begin_Date_UTC,
Lat_DD,
Lon_DD,
keep = c("nauticalDawn","sunset"),
tz = "UTC"))
View(all_ves_gmt8)
all_ves_gmt8 <- all_ves_gmt8 |>
mutate(nautDawn_UTC = twilight_times$nauticalDawn,
nautDawn_loc = with_tz(nautDawn_UTC, tzone = "Etc/GMT-8"),
sunset_UTC = twilight_times$nauticalDusk,
sunset_loc = with_tz(sunset_UTC, tzone = "Etc/GMT-8")) |>
mutate(
light_reg = case_when(
sun_elev_deg > 0 ~ "day",
sun_elev_deg < -12 ~ "night",
sun_elev_deg <= 0 & sun_elev_deg >= -12 & Hr_local_tz > nautDawn_loc ~ "dawn",
TRUE ~ "dusk"
))
all_ves_gmt8 <- all_ves_gmt8 |>
mutate(nautDawn_UTC = twilight_times$nauticalDawn,
nautDawn_loc = with_tz(nautDawn_UTC, tzone = "Etc/GMT-8"),
sunset_UTC = twilight_times$sunset,
sunset_loc = with_tz(sunset_UTC, tzone = "Etc/GMT-8")) |>
mutate(
light_reg = case_when(
sun_elev_deg > 0 ~ "day",
sun_elev_deg < -12 ~ "night",
sun_elev_deg <= 0 & sun_elev_deg >= -12 & Hr_local_tz > nautDawn_loc ~ "dawn",
TRUE ~ "dusk"
))
