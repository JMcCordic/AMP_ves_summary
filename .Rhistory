ggplot(data = diel_mean_npz,
aes(x = factor(Begin_Hour_loc),
y = mean_diel)) +
geom_pointrange(aes(ymin = sd_lower,
ymax = sd_upper,
group = npz_id.x)) +
geom_hline(yintercept = 0, colour = "grey50") +
facet_grid(rows = vars(npz_id.x))
ggplot(data = diel_mean_npz,
aes(x = factor(Begin_Hour_loc),
y = mean_diel)) +
geom_hline(yintercept = 0, colour = "grey50") +
geom_pointrange(aes(ymin = sd_lower,
ymax = sd_upper,
group = npz_id.x)) +
facet_grid(rows = vars(npz_id.x))
ggplot(data = diel_mean_npz,
aes(x = factor(Begin_Hour_loc),
y = mean_diel)) +
geom_hline(yintercept = 0, colour = "grey50") +
geom_pointrange(aes(ymin = sd_lower,
ymax = sd_upper,
group = npz_id.x)) +
labs(y = "Mean-adjusted average N vessels / hour",
x = "Hour of Day (Local TZ)")+
facet_grid(rows = vars(npz_id.x))
ggplot(data = diel_mean_npz,
aes(x = factor(Begin_Hour_loc),
y = mean_diel)) +
geom_hline(yintercept = 0, colour = "grey50") +
geom_pointrange(aes(ymin = sd_lower,
ymax = sd_upper,
group = npz_id.x)) +
labs(y = "Mean-adjusted average N vessels / hour",
x = "Hour of Day (Local TZ)")+
facet_grid(rows = vars(npz_id.x)) +
theme(
axis.text.x = element_text(face = "bold"),
strip.text.y = element_text(face = "bold")
)
ggplot(data = diel_mean_npz,
aes(x = factor(Begin_Hour_loc),
y = mean_diel)) +
geom_hline(yintercept = 0, colour = "grey50") +
geom_pointrange(aes(ymin = sd_lower,
ymax = sd_upper,
group = npz_id.x),
color = ifelse(mean_diel < 0, 'blue','red')) +
labs(y = "Mean-adjusted average N vessels / hour",
x = "Hour of Day (Local TZ)")+
facet_grid(rows = vars(npz_id.x)) +
theme(
axis.text.x = element_text(face = "bold"),
strip.text.y = element_text(face = "bold")
)
ggplot(data = diel_mean_npz,
aes(x = factor(Begin_Hour_loc),
y = mean_diel)) +
geom_hline(yintercept = 0, colour = "grey50") +
geom_pointrange(aes(ymin = sd_lower,
ymax = sd_upper,
group = npz_id.x,
color = ifelse(mean_diel < 0, 'blue','red')),
) +
labs(y = "Mean-adjusted average N vessels / hour",
x = "Hour of Day (Local TZ)")+
facet_grid(rows = vars(npz_id.x)) +
theme(
axis.text.x = element_text(face = "bold"),
strip.text.y = element_text(face = "bold")
)
ggplot(data = diel_mean_npz,
aes(x = factor(Begin_Hour_loc),
y = mean_diel)) +
geom_hline(yintercept = 0, colour = "grey50") +
geom_pointrange(aes(ymin = sd_lower,
ymax = sd_upper,
group = npz_id.x,
color = ifelse(mean_diel < 0, 'blue','red')),
show.legend = FALSE) +
labs(y = "Mean-adjusted average N vessels / hour",
x = "Hour of Day (Local TZ)")+
facet_grid(rows = vars(npz_id.x)) +
theme(
axis.text.x = element_text(face = "bold"),
strip.text.y = element_text(face = "bold")
)
ggplot(data = diel_mean_npz,
aes(x = factor(Begin_Hour_loc),
y = mean_diel)) +
geom_hline(yintercept = 0, colour = "grey50") +
geom_pointrange(aes(ymin = sd_lower,
ymax = sd_upper,
group = npz_id.x,
color = ifelse(mean_diel < 0, 'red','blue')),
show.legend = FALSE) +
labs(y = "Mean-adjusted average N vessels / hour",
x = "Hour of Day (Local TZ)")+
facet_grid(rows = vars(npz_id.x)) +
theme(
axis.text.x = element_text(face = "bold"),
strip.text.y = element_text(face = "bold")
)
ggplot(data = diel_mean_npz,
aes(x = factor(Begin_Hour_loc),
y = mean_diel)) +
geom_hline(yintercept = 0, colour = "grey50") +
geom_pointrange(aes(ymin = sd_lower,
ymax = sd_upper,
group = npz_id.x,
color = ifelse(mean_diel < 0, 'firebrick','blue')),
show.legend = FALSE) +
labs(y = "Mean-adjusted average N vessels / hour",
x = "Hour of Day (Local TZ)")+
facet_grid(rows = vars(npz_id.x)) +
theme(
axis.text.x = element_text(face = "bold"),
strip.text.y = element_text(face = "bold")
)
ggplot(data = diel_mean_npz,
aes(x = factor(Begin_Hour_loc),
y = mean_diel)) +
geom_hline(yintercept = 0, colour = "grey50") +
geom_pointrange(aes(ymin = sd_lower,
ymax = sd_upper,
group = npz_id.x,
color = ifelse(mean_diel < 0, 'firebrick','blue')),
show.legend = FALSE) +
scale_color_viridis_d()+
labs(y = "Mean-adjusted average N vessels / hour",
x = "Hour of Day (Local TZ)")+
facet_grid(rows = vars(npz_id.x)) +
theme(
axis.text.x = element_text(face = "bold"),
strip.text.y = element_text(face = "bold")
)
ggplot(data = diel_mean_npz,
aes(x = factor(Begin_Hour_loc),
y = mean_diel)) +
geom_hline(yintercept = 0, colour = "grey50") +
geom_pointrange(aes(ymin = sd_lower,
ymax = sd_upper,
group = npz_id.x,
color = ifelse(mean_diel < 0, 'firebrick','blue')),
show.legend = FALSE) +
scale_color_rickandmorty()+
labs(y = "Mean-adjusted average N vessels / hour",
x = "Hour of Day (Local TZ)")+
facet_grid(rows = vars(npz_id.x)) +
theme(
axis.text.x = element_text(face = "bold"),
strip.text.y = element_text(face = "bold")
)
ggplot(data = diel_mean_npz,
aes(x = factor(Begin_Hour_loc),
y = mean_diel)) +
geom_hline(yintercept = 0, colour = "grey50") +
geom_pointrange(aes(ymin = sd_lower,
ymax = sd_upper,
group = npz_id.x,
color = ifelse(mean_diel < 0, 'firebrick','blue')),
show.legend = FALSE) +
scale_color_viridis_d(begin = 0.3, end = 0.7)+
labs(y = "Mean-adjusted average N vessels / hour",
x = "Hour of Day (Local TZ)")+
facet_grid(rows = vars(npz_id.x)) +
theme(
axis.text.x = element_text(face = "bold"),
strip.text.y = element_text(face = "bold")
)
ggplot(data = diel_mean_npz,
aes(x = factor(Begin_Hour_loc),
y = mean_diel)) +
geom_hline(yintercept = 0, colour = "grey50") +
geom_pointrange(aes(ymin = sd_lower,
ymax = sd_upper,
group = npz_id.x,
color = ifelse(mean_diel < 0, 'firebrick','blue')),
show.legend = FALSE) +
scale_color_viridis_d(begin = 0.3, end = 0.9)+
labs(y = "Mean-adjusted average N vessels / hour",
x = "Hour of Day (Local TZ)")+
facet_grid(rows = vars(npz_id.x)) +
theme(
axis.text.x = element_text(face = "bold"),
strip.text.y = element_text(face = "bold")
)
ggplot(data = diel_mean_npz,
aes(x = factor(Begin_Hour_loc),
y = mean_diel)) +
geom_hline(yintercept = 0, colour = "grey50") +
geom_pointrange(aes(ymin = sd_lower,
ymax = sd_upper,
group = npz_id.x,
color = ifelse(mean_diel < 0, 'firebrick','blue')),
show.legend = FALSE) +
scale_color_viridis_d(begin = 0.3, end = 0.8)+
labs(y = "Mean-adjusted average N vessels / hour",
x = "Hour of Day (Local TZ)")+
facet_grid(rows = vars(npz_id.x)) +
theme(
axis.text.x = element_text(face = "bold"),
strip.text.y = element_text(face = "bold")
)
ggplot(data = diel_mean_npz,
aes(x = factor(Begin_Hour_loc),
y = mean_diel)) +
geom_hline(yintercept = 0, colour = "grey50") +
geom_pointrange(aes(ymin = sd_lower,
ymax = sd_upper,
group = npz_id.x,
color = ifelse(mean_diel < 0, 'firebrick','blue')),
show.legend = FALSE) +
scale_color_viridis_d(begin = 0.4, end = 0.8)+
labs(y = "Mean-adjusted average N vessels / hour",
x = "Hour of Day (Local TZ)")+
facet_grid(rows = vars(npz_id.x)) +
theme(
axis.text.x = element_text(face = "bold"),
strip.text.y = element_text(face = "bold")
)
ggplot(data = diel_mean_npz,
aes(x = factor(Begin_Hour_loc),
y = mean_diel)) +
geom_hline(yintercept = 0, colour = "grey50") +
geom_pointrange(aes(ymin = sd_lower,
ymax = sd_upper,
group = npz_id.x,
color = ifelse(mean_diel < 0, 'firebrick','blue')),
show.legend = FALSE) +
scale_color_viridis_d(begin = 0.4, end = 0.8, option = "C")+
labs(y = "Mean-adjusted average N vessels / hour",
x = "Hour of Day (Local TZ)")+
facet_grid(rows = vars(npz_id.x)) +
theme(
axis.text.x = element_text(face = "bold"),
strip.text.y = element_text(face = "bold")
)
ggplot(data = diel_mean_npz,
aes(x = factor(Begin_Hour_loc),
y = mean_diel)) +
geom_hline(yintercept = 0, colour = "grey50") +
geom_pointrange(aes(ymin = sd_lower,
ymax = sd_upper,
group = npz_id.x,
color = ifelse(mean_diel < 0, 'firebrick','blue')),
show.legend = FALSE) +
scale_color_viridis_d(option = "C")+
labs(y = "Mean-adjusted average N vessels / hour",
x = "Hour of Day (Local TZ)")+
facet_grid(rows = vars(npz_id.x)) +
theme(
axis.text.x = element_text(face = "bold"),
strip.text.y = element_text(face = "bold")
)
ggplot(data = diel_mean_npz,
aes(x = factor(Begin_Hour_loc),
y = mean_diel)) +
geom_hline(yintercept = 0, colour = "grey50") +
geom_pointrange(aes(ymin = sd_lower,
ymax = sd_upper,
group = npz_id.x,
color = ifelse(mean_diel < 0, 'firebrick','blue')),
show.legend = FALSE) +
scale_color_viridis_d(begin = 0.2, end = 0.8, option = "H")+
labs(y = "Mean-adjusted average N vessels / hour",
x = "Hour of Day (Local TZ)")+
facet_grid(rows = vars(npz_id.x)) +
theme(
axis.text.x = element_text(face = "bold"),
strip.text.y = element_text(face = "bold")
)
ggplot(data = diel_mean_npz,
aes(x = factor(Begin_Hour_loc),
y = mean_diel)) +
geom_hline(yintercept = 0, colour = "grey50") +
geom_pointrange(aes(ymin = sd_lower,
ymax = sd_upper,
group = npz_id.x,
color = ifelse(mean_diel < 0, 'firebrick','blue')),
show.legend = FALSE) +
scale_color_viridis_d(begin = 0.2, end = 0.9, option = "H")+
labs(y = "Mean-adjusted average N vessels / hour",
x = "Hour of Day (Local TZ)")+
facet_grid(rows = vars(npz_id.x)) +
theme(
axis.text.x = element_text(face = "bold"),
strip.text.y = element_text(face = "bold")
)
ggplot(data = diel_mean_npz,
aes(x = factor(Begin_Hour_loc),
y = mean_diel)) +
geom_hline(yintercept = 0, colour = "grey50") +
geom_pointrange(aes(ymin = sd_lower,
ymax = sd_upper,
group = npz_id.x,
color = ifelse(mean_diel < 0, 'firebrick','blue')),
show.legend = FALSE) +
scale_color_viridis_d(begin = 0.1, end = 0.9, option = "H")+
labs(y = "Mean-adjusted average N vessels / hour",
x = "Hour of Day (Local TZ)")+
facet_grid(rows = vars(npz_id.x)) +
theme(
axis.text.x = element_text(face = "bold"),
strip.text.y = element_text(face = "bold")
)
ggplot(data = diel_mean_npz,
aes(x = factor(Begin_Hour_loc),
y = mean_diel)) +
geom_hline(yintercept = 0, colour = "grey50") +
geom_pointrange(aes(ymin = sd_lower,
ymax = sd_upper,
group = npz_id.x,
color = ifelse(mean_diel < 0, 'firebrick','blue')),
show.legend = FALSE) +
scale_color_viridis_d(begin = 0.1, end = 0.9,
option = "H",
direction = -1)+
labs(y = "Mean-adjusted average N vessels / hour",
x = "Hour of Day (Local TZ)")+
facet_grid(rows = vars(npz_id.x)) +
theme(
axis.text.x = element_text(face = "bold"),
strip.text.y = element_text(face = "bold")
)
ggsave(paste0("figs/", "Diel_mean_adj_npz.png"), width=8, height=10, units="in", dpi=300)
ggplot(data = diel_mean_npz,
aes(x = factor(Begin_Hour_loc),
y = mean_diel)) +
geom_hline(yintercept = 0, colour = "grey50") +
geom_pointrange(aes(ymin = sd_lower,
ymax = sd_upper,
group = npz_id.x,
color = ifelse(mean_diel < 0, 'firebrick','blue')),
size = 0.5,
show.legend = FALSE) +
scale_color_viridis_d(begin = 0.1, end = 0.9,
option = "H",
direction = -1)+
labs(y = "Mean-adjusted average N vessels / hour",
x = "Hour of Day (Local TZ)")+
facet_grid(rows = vars(npz_id.x)) +
theme(
axis.text.x = element_text(face = "bold"),
strip.text.y = element_text(face = "bold")
)
ggplot(data = diel_mean_npz,
aes(x = factor(Begin_Hour_loc),
y = mean_diel)) +
geom_hline(yintercept = 0, colour = "grey50") +
geom_pointrange(aes(ymin = sd_lower,
ymax = sd_upper,
group = npz_id.x,
color = ifelse(mean_diel < 0, 'firebrick','blue')),
size = 0.25,
show.legend = FALSE) +
scale_color_viridis_d(begin = 0.1, end = 0.9,
option = "H",
direction = -1)+
labs(y = "Mean-adjusted average N vessels / hour",
x = "Hour of Day (Local TZ)")+
facet_grid(rows = vars(npz_id.x)) +
theme(
axis.text.x = element_text(face = "bold"),
strip.text.y = element_text(face = "bold")
)
ggsave(paste0("figs/", "Diel_mean_adj_npz.png"), width=8, height=10, units="in", dpi=300)
ggplot(data = diel_mean_npz,
aes(x = factor(Begin_Hour_loc),
y = mean_diel)) +
geom_hline(yintercept = 0, colour = "grey50") +
geom_pointrange(aes(ymin = sd_lower,
ymax = sd_upper,
group = npz_id.x,
color = ifelse(mean_diel < 0, 'firebrick','blue')),
size = 0.25,
show.legend = FALSE) +
scale_color_viridis_d(begin = 0.3, end = 0.9,
option = "H",
direction = -1)+
labs(y = "Mean-adjusted average N vessels / hour",
x = "Hour of Day (Local TZ)")+
facet_grid(rows = vars(npz_id.x)) +
theme(
axis.text.x = element_text(face = "bold"),
strip.text.y = element_text(face = "bold")
)
ggplot(data = diel_mean_npz,
aes(x = factor(Begin_Hour_loc),
y = mean_diel)) +
geom_hline(yintercept = 0, colour = "grey50") +
geom_pointrange(aes(ymin = sd_lower,
ymax = sd_upper,
group = npz_id.x,
color = ifelse(mean_diel < 0, 'firebrick','blue')),
size = 0.25,
show.legend = FALSE) +
scale_color_viridis_d(begin = 0.3, end = 0.7,
option = "H",
direction = -1)+
labs(y = "Mean-adjusted average N vessels / hour",
x = "Hour of Day (Local TZ)")+
facet_grid(rows = vars(npz_id.x)) +
theme(
axis.text.x = element_text(face = "bold"),
strip.text.y = element_text(face = "bold")
)
ggsave(paste0("figs/", "Diel_mean_adj_npz.png"), width=8, height=10, units="in", dpi=300)
View(diel_mean_npz)
?chisq.test
M <- as.table(rbind(c(762, 327, 468), c(484, 239, 477)))
dimnames(M) <- list(gender = c("F", "M"),
party = c("Democrat","Independent", "Republican"))
M
(Xsq <- chisq.test(M))
Xsq$observed   # observed counts (same as M)
Xsq$expected   # expected counts under the null
Xsq$residuals  # Pearson residuals
Xsq$stdres     # standardized residuals
### Export CSV summary tables
### Compare CGMP deployments
cgmp_wkdy < -all_ves_wkdy |>
filter(Site_ID == "CG")
### Compare CGMP deployments
cgmp_wkdy <- all_ves_wkdy |>
filter(Site_ID == "CG")
View(cgmp_wkdy)
### Compare CGMP deployments
cgmp_wkdy <- all_ves_wkdy |>
filter(Site_ID == "CG") |>
group_by(Dep, Weekday) |>
summarise(Total_ves_dep = sum(Total_ves_dep))
View(cgmp_wkdy)
write_csv(cgmp_wkdy,
file = "output/CGMP_by_weekday.csv")
### Compare CGMP deployments
cgmp_wkdy <- all_ves_wkdy |>
filter(Site_ID == "CG") |>
group_by(Dep, Weekday) |>
summarise(Total_ves_dep = sum(Total_ves_dep)) |>
pivot_wider()
### Compare CGMP deployments
cgmp_wkdy <- all_ves_wkdy |>
filter(Site_ID == "CG") |>
group_by(Dep, Weekday) |>
summarise(Total_ves_dep = sum(Total_ves_dep)) |>
pivot_wider(cols = Weekday)
### Compare CGMP deployments
cgmp_wkdy <- all_ves_wkdy |>
filter(Site_ID == "CG") |>
group_by(Dep, Weekday) |>
summarise(Total_ves_dep = sum(Total_ves_dep)) |>
pivot_wider(names_from = Dep, values_from = Total_ves_dep)
View(cgmp_wkdy)
write_csv(cgmp_wkdy,
file = "output/CGMP_by_weekday.csv")
chisq.test(cgmp_wkdy)
chisq.test(cgmp_wkdy)
View(cgmp_wkdy)
chisq.test(as.table(cgmp_wkdy))
as.table(cgmp_wkdy)
cgmp_wkdy
as.data.frame(cgmp_wkdy)
chisq.test(as.data.frame(cgmp_wkdy))
chisq.test(as.data.frame(cgmp_wkdy, row.names = FALSE))
chisq.test(as.data.frame(cgmp_wkdy[-Weekday,], row.names = FALSE))
chisq.test(as.data.frame(cgmp_wkdy[,2:4], row.names = FALSE))
xsq <- chisq.test(as.data.frame(cgmp_wkdy[,2:4], row.names = FALSE))
xsq$observed
xsq$expected
View(all_ves_wkdy)
### Compare SIMP deployments
simp_wkdy <- all_ves_wkdy |>
filter(npz_id == "SIMP")|>
group_by(Dep, Weekday) |>
summarise(Total_ves_dep = sum(Total_ves_dep)) |>
pivot_wider(names_from = Dep, values_from = Total_ves_dep)
View(simp_wkdy)
xsq <- chisq.test(as.data.frame(simp_wkdy[,2:3], row.names = FALSE))
xsq
xsq <- chisq.test(as.data.frame(simp_wkdy[,4:5], row.names = FALSE))
xsq
xsq <- chisq.test(as.data.frame(simp_wkdy[,6:7], row.names = FALSE))
xsq
# summarize daily totals to get mean-adjusted counts per weekday
wkly_means <- all_ves_wkdy |>
group_by(network, npz_id, Site_ID, Dep, Date_week) |>
summarize(n_days = n(),
mean_wk_tot = mean(Total_ves_dep, na.rm = TRUE),
mean_wk_ins = mean(Total_inside, na.rm = TRUE),
mean_wk_ins_sm = mean(Total_inside_small, na.rm = TRUE),
mean_wk_trans = mean(Inside_transit, na.rm = TRUE),
mean_wk_trans_sm = mean(Inside_transit_small, na.rm = TRUE),
mean_wk_man = mean(Inside_maneuver, na.rm = TRUE),
mean_wk_man_sm = mean(Inside_maneuver_small, na.rm = TRUE))
chisq.test(as.data.frame(simp_wkdy[,6:7], row.names = FALSE))
# test if WP subset to same dates is different
simp_epwp_dates <- all_ves_wkdy |>
filter(npz_id == "SIMP",
Begin_Date_loc > "2019-06-10" & Begin_Date_loc < "2019-06-30")
# test if WP subset to same dates is different
simp_epwp_dates <- all_ves_wkdy |>
filter(npz_id == "SIMP",
Begin_Date_loc > "2019-06-10" & Begin_Date_loc < "2019-06-30") |>
group_by(Dep, Weekday) |>
summarise(Total_ves_dep = sum(Total_ves_dep)) |>
pivot_wider(names_from = Dep, values_from = Total_ves_dep)
View(simp_epwp_dates)
chisq.test(as.data.frame(simp_ep_wp_dates[,2:3], row.names = FALSE))
chisq.test(as.data.frame(simp_epwp_dates[,2:3], row.names = FALSE))
chisq.test(as.data.frame(simp_wkdy[,2:7], row.names = FALSE))
chisq.test(as.data.frame(simp_wkdy[,2:6], row.names = FALSE))
